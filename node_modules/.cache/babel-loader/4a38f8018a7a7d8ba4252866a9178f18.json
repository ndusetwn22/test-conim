{"ast":null,"code":"import _regeneratorRuntime from \"/Users/pandusetiawan/Documents/react/df-v1.2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";\nimport _asyncToGenerator from \"/Users/pandusetiawan/Documents/react/df-v1.2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";\nimport _classCallCheck from \"/Users/pandusetiawan/Documents/react/df-v1.2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/Users/pandusetiawan/Documents/react/df-v1.2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/Users/pandusetiawan/Documents/react/df-v1.2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/Users/pandusetiawan/Documents/react/df-v1.2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/Users/pandusetiawan/Documents/react/df-v1.2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nvar _jsxFileName = \"/Users/pandusetiawan/Documents/react/df-v1.2/src/views/apps/chat/ChatSidebar.js\";\nimport React from \"react\";\nimport { Card, FormGroup, Input, Badge } from \"reactstrap\";\nimport { X, Search } from \"react-feather\";\nimport PerfectScrollbar from \"react-perfect-scrollbar\";\nimport { connect } from \"react-redux\";\nimport { getChats, getContactChats, searchContacts, markSeenAllMessages } from \"../../../redux/actions/chat/index\";\nimport userImg from \"../../../assets/img/portrait/small/avatar-s-11.jpg\";\n\nvar ChatSidebar = /*#__PURE__*/function (_React$Component) {\n  _inherits(ChatSidebar, _React$Component);\n\n  function ChatSidebar() {\n    var _getPrototypeOf2;\n\n    var _this;\n\n    _classCallCheck(this, ChatSidebar);\n\n    for (var _len = arguments.length, args = new Array(_len), _key = 0; _key < _len; _key++) {\n      args[_key] = arguments[_key];\n    }\n\n    _this = _possibleConstructorReturn(this, (_getPrototypeOf2 = _getPrototypeOf(ChatSidebar)).call.apply(_getPrototypeOf2, [this].concat(args)));\n    _this.state = {\n      chatsContacts: [],\n      contacts: [],\n      messages: [],\n      status: null,\n      value: \"\"\n    };\n\n    _this.getChatContents = function () {\n      _this.props.getChats();\n\n      _this.props.getContactChats();\n    };\n\n    _this.handleOnChange = function (e) {\n      _this.setState({\n        value: e.target.value\n      });\n\n      _this.props.searchContacts(e.target.value);\n    };\n\n    return _this;\n  }\n\n  _createClass(ChatSidebar, [{\n    key: \"componentDidMount\",\n    value: function () {\n      var _componentDidMount = _asyncToGenerator( /*#__PURE__*/_regeneratorRuntime.mark(function _callee() {\n        return _regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.next = 2;\n                return this.getChatContents();\n\n              case 2:\n                this.setState({\n                  chatsContacts: this.props.chat.chatContacts,\n                  contacts: this.props.chat.contacts,\n                  chats: this.props.chat.chats,\n                  status: this.props.chat.status\n                });\n\n              case 3:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this);\n      }));\n\n      function componentDidMount() {\n        return _componentDidMount.apply(this, arguments);\n      }\n\n      return componentDidMount;\n    }()\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      var _this$state = this.state,\n          contacts = _this$state.contacts,\n          chatsContacts = _this$state.chatsContacts,\n          chats = _this$state.chats,\n          status = _this$state.status,\n          value = _this$state.value;\n      var contactsArr = value.length ? this.props.chat.filteredContacts : contacts;\n      var chatsArr = value.length ? this.props.chat.filteredChats : chatsContacts;\n      var renderContacts = contactsArr.length > 0 ? contactsArr.map(function (contact) {\n        return /*#__PURE__*/React.createElement(\"li\", {\n          key: contact.uid,\n          onClick: function onClick() {\n            _this2.props.handleActiveChat(contact.uid, contact, chats[contact.uid]);\n\n            _this2.props.markSeenAllMessages(contact.uid);\n\n            _this2.props.mainSidebar(false);\n          },\n          __self: _this2,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 71,\n            columnNumber: 13\n          }\n        }, /*#__PURE__*/React.createElement(\"div\", {\n          className: \"pr-1\",\n          __self: _this2,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 83,\n            columnNumber: 15\n          }\n        }, /*#__PURE__*/React.createElement(\"span\", {\n          className: \"avatar avatar-md m-0\",\n          __self: _this2,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 84,\n            columnNumber: 17\n          }\n        }, /*#__PURE__*/React.createElement(\"img\", {\n          src: contact.photoURL,\n          alt: contact.displayName,\n          height: \"38\",\n          width: \"38\",\n          __self: _this2,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 85,\n            columnNumber: 19\n          }\n        }))), /*#__PURE__*/React.createElement(\"div\", {\n          className: \"user-chat-info\",\n          __self: _this2,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 93,\n            columnNumber: 15\n          }\n        }, /*#__PURE__*/React.createElement(\"div\", {\n          className: \"contact-info\",\n          __self: _this2,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 94,\n            columnNumber: 17\n          }\n        }, /*#__PURE__*/React.createElement(\"h5\", {\n          className: \"text-bold-600 mb-0\",\n          __self: _this2,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 95,\n            columnNumber: 19\n          }\n        }, contact.displayName), /*#__PURE__*/React.createElement(\"p\", {\n          className: \"truncate\",\n          __self: _this2,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 96,\n            columnNumber: 19\n          }\n        }, contact.about))));\n      }) : null;\n      var renderChats = chatsArr && Array.isArray(chatsArr) ? chatsArr.map(function (chat) {\n        var lastMsg = chats[chat.uid] && chats[chat.uid].msg ? chats[chat.uid].msg.slice(-1)[0] : null,\n            lastMsgDate = new Date(lastMsg && lastMsg.time ? lastMsg.time : null),\n            lastMsgMonth = lastMsgDate.toLocaleString(\"default\", {\n          month: \"short\"\n        }),\n            lastMsgDay = lastMsgDate.getDate();\n        var pendingMsg = chats[chat.uid] && chats[chat.uid].msg ? chats[chat.uid].msg.filter(function (i) {\n          return i.isSeen === false && i.isSent !== true;\n        }).length : null;\n        var activeID = chats[chat.uid] !== undefined ? chats[chat.uid] : null;\n        return /*#__PURE__*/React.createElement(\"li\", {\n          key: chat.uid,\n          onClick: function onClick() {\n            _this2.props.handleActiveChat(chat.uid, chat, activeID);\n\n            _this2.props.mainSidebar(false);\n\n            _this2.props.markSeenAllMessages(chat.uid);\n          },\n          className: \"\".concat(_this2.props.activeChatID === chat.uid ? \"active\" : \"\"),\n          __self: _this2,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 125,\n            columnNumber: 15\n          }\n        }, /*#__PURE__*/React.createElement(\"div\", {\n          className: \"pr-1\",\n          __self: _this2,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 136,\n            columnNumber: 17\n          }\n        }, /*#__PURE__*/React.createElement(\"span\", {\n          className: \"avatar avatar-md m-0\",\n          __self: _this2,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 137,\n            columnNumber: 19\n          }\n        }, /*#__PURE__*/React.createElement(\"img\", {\n          src: chat.photoURL,\n          alt: chat.displayName,\n          height: \"38\",\n          width: \"38\",\n          __self: _this2,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 138,\n            columnNumber: 21\n          }\n        }))), /*#__PURE__*/React.createElement(\"div\", {\n          className: \"user-chat-info\",\n          __self: _this2,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 146,\n            columnNumber: 17\n          }\n        }, /*#__PURE__*/React.createElement(\"div\", {\n          className: \"contact-info\",\n          __self: _this2,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 147,\n            columnNumber: 19\n          }\n        }, /*#__PURE__*/React.createElement(\"h5\", {\n          className: \"text-bold-600 mb-0\",\n          __self: _this2,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 148,\n            columnNumber: 21\n          }\n        }, chat.displayName), /*#__PURE__*/React.createElement(\"p\", {\n          className: \"truncate\",\n          __self: _this2,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 149,\n            columnNumber: 21\n          }\n        }, lastMsg ? lastMsg.textContent : chat.about)), /*#__PURE__*/React.createElement(\"div\", {\n          className: \"contact-meta d-flex- flex-column\",\n          __self: _this2,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 153,\n            columnNumber: 19\n          }\n        }, /*#__PURE__*/React.createElement(\"span\", {\n          className: \"float-right mb-25\",\n          __self: _this2,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 154,\n            columnNumber: 21\n          }\n        }, lastMsgMonth + \" \" + lastMsgDay), pendingMsg > 0 ? /*#__PURE__*/React.createElement(\"div\", {\n          className: \"unseen-msg\",\n          __self: _this2,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 158,\n            columnNumber: 23\n          }\n        }, /*#__PURE__*/React.createElement(Badge, {\n          className: \"badge-md float-right\",\n          color: \"primary\",\n          pill: true,\n          __self: _this2,\n          __source: {\n            fileName: _jsxFileName,\n            lineNumber: 159,\n            columnNumber: 25\n          }\n        }, pendingMsg)) : null)));\n      }) : null;\n      return /*#__PURE__*/React.createElement(Card, {\n        className: \"sidebar-content h-100\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 175,\n          columnNumber: 7\n        }\n      }, /*#__PURE__*/React.createElement(\"span\", {\n        className: \"sidebar-close-icon\",\n        onClick: function onClick() {\n          return _this2.props.mainSidebar(false);\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 176,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(X, {\n        size: 15,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 180,\n          columnNumber: 11\n        }\n      })), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"chat-fixed-search\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 182,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"d-flex align-items-center\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 183,\n          columnNumber: 11\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"sidebar-profile-toggle position-relative d-inline-flex\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 184,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(\"div\", {\n        className: \"avatar\",\n        onClick: function onClick() {\n          return _this2.props.handleUserSidebar(\"open\");\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 185,\n          columnNumber: 15\n        }\n      }, /*#__PURE__*/React.createElement(\"img\", {\n        src: userImg,\n        alt: \"User Profile\",\n        height: \"40\",\n        width: \"40\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 189,\n          columnNumber: 17\n        }\n      }), /*#__PURE__*/React.createElement(\"span\", {\n        className: status === \"dnd\" ? \"avatar-status-busy\" : status === \"away\" ? \"avatar-status-away\" : status === \"offline\" ? \"avatar-status-offline\" : \"avatar-status-online\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 190,\n          columnNumber: 17\n        }\n      }))), /*#__PURE__*/React.createElement(FormGroup, {\n        className: \"position-relative has-icon-left mx-1 my-0 w-100\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 203,\n          columnNumber: 13\n        }\n      }, /*#__PURE__*/React.createElement(Input, {\n        className: \"round\",\n        type: \"text\",\n        placeholder: \"Search contact or start a new chat\",\n        onChange: function onChange(e) {\n          return _this2.handleOnChange(e);\n        },\n        value: value,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 204,\n          columnNumber: 15\n        }\n      }), /*#__PURE__*/React.createElement(\"div\", {\n        className: \"form-control-position\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 211,\n          columnNumber: 15\n        }\n      }, /*#__PURE__*/React.createElement(Search, {\n        size: 15,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 212,\n          columnNumber: 17\n        }\n      }))))), /*#__PURE__*/React.createElement(PerfectScrollbar, {\n        className: \"chat-user-list list-group\",\n        options: {\n          wheelPropagation: false\n        },\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 217,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(\"h3\", {\n        className: \"primary p-1 mb-0\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 223,\n          columnNumber: 11\n        }\n      }, \"Chats\"), /*#__PURE__*/React.createElement(\"ul\", {\n        className: \"chat-users-list-wrapper media-list\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 224,\n          columnNumber: 11\n        }\n      }, renderChats), /*#__PURE__*/React.createElement(\"h3\", {\n        className: \"primary p-1 mb-0\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 225,\n          columnNumber: 11\n        }\n      }, \"Contacts\"), /*#__PURE__*/React.createElement(\"ul\", {\n        className: \"chat-users-list-wrapper media-list\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 226,\n          columnNumber: 11\n        }\n      }, renderContacts)));\n    }\n  }], [{\n    key: \"getDerivedStateFromProps\",\n    value: function getDerivedStateFromProps(props, state) {\n      if (props.chat.chatContacts.length !== state.chatContacts || props.chat.contacts.length !== state.contacts || props.chat.chats.length !== state.chats || props.chat.status !== state.status) {\n        return {\n          chatsContacts: props.chat.chatContacts,\n          contacts: props.chat.contacts,\n          chats: props.chat.chats,\n          status: props.chat.status\n        };\n      } // Return null if the state hasn't changed\n\n\n      return null;\n    }\n  }]);\n\n  return ChatSidebar;\n}(React.Component);\n\nvar mapStateToProps = function mapStateToProps(state) {\n  return {\n    chat: state.chatApp.chats\n  };\n};\n\nexport default connect(mapStateToProps, {\n  getChats: getChats,\n  getContactChats: getContactChats,\n  searchContacts: searchContacts,\n  markSeenAllMessages: markSeenAllMessages\n})(ChatSidebar);","map":{"version":3,"sources":["/Users/pandusetiawan/Documents/react/df-v1.2/src/views/apps/chat/ChatSidebar.js"],"names":["React","Card","FormGroup","Input","Badge","X","Search","PerfectScrollbar","connect","getChats","getContactChats","searchContacts","markSeenAllMessages","userImg","ChatSidebar","state","chatsContacts","contacts","messages","status","value","getChatContents","props","handleOnChange","e","setState","target","chat","chatContacts","chats","contactsArr","length","filteredContacts","chatsArr","filteredChats","renderContacts","map","contact","uid","handleActiveChat","mainSidebar","photoURL","displayName","about","renderChats","Array","isArray","lastMsg","msg","slice","lastMsgDate","Date","time","lastMsgMonth","toLocaleString","month","lastMsgDay","getDate","pendingMsg","filter","i","isSeen","isSent","activeID","undefined","activeChatID","textContent","handleUserSidebar","wheelPropagation","Component","mapStateToProps","chatApp"],"mappings":"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","sourcesContent":["import React from \"react\"\nimport { Card, FormGroup, Input, Badge } from \"reactstrap\"\nimport { X, Search } from \"react-feather\"\nimport PerfectScrollbar from \"react-perfect-scrollbar\"\nimport { connect } from \"react-redux\"\nimport {\n  getChats,\n  getContactChats,\n  searchContacts,\n  markSeenAllMessages\n} from \"../../../redux/actions/chat/index\"\nimport userImg from \"../../../assets/img/portrait/small/avatar-s-11.jpg\"\n\nclass ChatSidebar extends React.Component {\n  static getDerivedStateFromProps(props, state) {\n    if (\n      props.chat.chatContacts.length !== state.chatContacts ||\n      props.chat.contacts.length !== state.contacts ||\n      props.chat.chats.length !== state.chats ||\n      props.chat.status !== state.status\n    ) {\n      return {\n        chatsContacts: props.chat.chatContacts,\n        contacts: props.chat.contacts,\n        chats: props.chat.chats,\n        status: props.chat.status\n      }\n    }\n    // Return null if the state hasn't changed\n    return null\n  }\n  state = {\n    chatsContacts: [],\n    contacts: [],\n    messages: [],\n    status: null,\n    value: \"\"\n  }\n\n  getChatContents = () => {\n    this.props.getChats()\n    this.props.getContactChats()\n  }\n\n  async componentDidMount() {\n    await this.getChatContents()\n    this.setState({\n      chatsContacts: this.props.chat.chatContacts,\n      contacts: this.props.chat.contacts,\n      chats: this.props.chat.chats,\n      status: this.props.chat.status\n    })\n  }\n\n  handleOnChange = e => {\n    this.setState({ value: e.target.value })\n    this.props.searchContacts(e.target.value)\n  }\n\n  render() {\n    const { contacts, chatsContacts, chats, status, value } = this.state\n    const contactsArr = value.length\n      ? this.props.chat.filteredContacts\n      : contacts\n    const chatsArr = value.length\n      ? this.props.chat.filteredChats\n      : chatsContacts\n    let renderContacts =\n      contactsArr.length > 0\n        ? contactsArr.map(contact => (\n            <li\n              key={contact.uid}\n              onClick={() => {\n                this.props.handleActiveChat(\n                  contact.uid,\n                  contact,\n                  chats[contact.uid]\n                )\n                this.props.markSeenAllMessages(contact.uid)\n                this.props.mainSidebar(false)\n              }}\n            >\n              <div className=\"pr-1\">\n                <span className=\"avatar avatar-md m-0\">\n                  <img\n                    src={contact.photoURL}\n                    alt={contact.displayName}\n                    height=\"38\"\n                    width=\"38\"\n                  />\n                </span>\n              </div>\n              <div className=\"user-chat-info\">\n                <div className=\"contact-info\">\n                  <h5 className=\"text-bold-600 mb-0\">{contact.displayName}</h5>\n                  <p className=\"truncate\">{contact.about}</p>\n                </div>\n              </div>\n            </li>\n          ))\n        : null\n    let renderChats =\n      chatsArr && Array.isArray(chatsArr)\n        ? chatsArr.map(chat => {\n            let lastMsg =\n                chats[chat.uid] && chats[chat.uid].msg\n                  ? chats[chat.uid].msg.slice(-1)[0]\n                  : null,\n              lastMsgDate = new Date(\n                lastMsg && lastMsg.time ? lastMsg.time : null\n              ),\n              lastMsgMonth = lastMsgDate.toLocaleString(\"default\", {\n                month: \"short\"\n              }),\n              lastMsgDay = lastMsgDate.getDate()\n            let pendingMsg =\n              chats[chat.uid] && chats[chat.uid].msg\n                ? chats[chat.uid].msg.filter(\n                    i => i.isSeen === false && i.isSent !== true\n                  ).length\n                : null\n            let activeID =\n              chats[chat.uid] !== undefined ? chats[chat.uid] : null\n            return (\n              <li\n                key={chat.uid}\n                onClick={() => {\n                  this.props.handleActiveChat(chat.uid, chat, activeID)\n                  this.props.mainSidebar(false)\n                  this.props.markSeenAllMessages(chat.uid)\n                }}\n                className={`${\n                  this.props.activeChatID === chat.uid ? \"active\" : \"\"\n                }`}\n              >\n                <div className=\"pr-1\">\n                  <span className=\"avatar avatar-md m-0\">\n                    <img\n                      src={chat.photoURL}\n                      alt={chat.displayName}\n                      height=\"38\"\n                      width=\"38\"\n                    />\n                  </span>\n                </div>\n                <div className=\"user-chat-info\">\n                  <div className=\"contact-info\">\n                    <h5 className=\"text-bold-600 mb-0\">{chat.displayName}</h5>\n                    <p className=\"truncate\">\n                      {lastMsg ? lastMsg.textContent : chat.about}\n                    </p>\n                  </div>\n                  <div className=\"contact-meta d-flex- flex-column\">\n                    <span className=\"float-right mb-25\">\n                      {lastMsgMonth + \" \" + lastMsgDay}\n                    </span>\n                    {pendingMsg > 0 ? (\n                      <div className=\"unseen-msg\">\n                        <Badge\n                          className=\"badge-md float-right\"\n                          color=\"primary\"\n                          pill\n                        >\n                          {pendingMsg}\n                        </Badge>\n                      </div>\n                    ) : null}\n                  </div>\n                </div>\n              </li>\n            )\n          })\n        : null\n    return (\n      <Card className=\"sidebar-content h-100\">\n        <span\n          className=\"sidebar-close-icon\"\n          onClick={() => this.props.mainSidebar(false)}\n        >\n          <X size={15} />\n        </span>\n        <div className=\"chat-fixed-search\">\n          <div className=\"d-flex align-items-center\">\n            <div className=\"sidebar-profile-toggle position-relative d-inline-flex\">\n              <div\n                className=\"avatar\"\n                onClick={() => this.props.handleUserSidebar(\"open\")}\n              >\n                <img src={userImg} alt=\"User Profile\" height=\"40\" width=\"40\" />\n                <span\n                  className={\n                    status === \"dnd\"\n                      ? \"avatar-status-busy\"\n                      : status === \"away\"\n                      ? \"avatar-status-away\"\n                      : status === \"offline\"\n                      ? \"avatar-status-offline\"\n                      : \"avatar-status-online\"\n                  }\n                />\n              </div>\n            </div>\n            <FormGroup className=\"position-relative has-icon-left mx-1 my-0 w-100\">\n              <Input\n                className=\"round\"\n                type=\"text\"\n                placeholder=\"Search contact or start a new chat\"\n                onChange={e => this.handleOnChange(e)}\n                value={value}\n              />\n              <div className=\"form-control-position\">\n                <Search size={15} />\n              </div>\n            </FormGroup>\n          </div>\n        </div>\n        <PerfectScrollbar\n          className=\"chat-user-list list-group\"\n          options={{\n            wheelPropagation: false\n          }}\n        >\n          <h3 className=\"primary p-1 mb-0\">Chats</h3>\n          <ul className=\"chat-users-list-wrapper media-list\">{renderChats}</ul>\n          <h3 className=\"primary p-1 mb-0\">Contacts</h3>\n          <ul className=\"chat-users-list-wrapper media-list\">\n            {renderContacts}\n          </ul>\n        </PerfectScrollbar>\n      </Card>\n    )\n  }\n}\n\nconst mapStateToProps = state => {\n  return {\n    chat: state.chatApp.chats\n  }\n}\nexport default connect(mapStateToProps, {\n  getChats,\n  getContactChats,\n  searchContacts,\n  markSeenAllMessages\n})(ChatSidebar)\n"]},"metadata":{},"sourceType":"module"}