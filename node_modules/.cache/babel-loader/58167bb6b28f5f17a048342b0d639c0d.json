{"ast":null,"code":"import _classCallCheck from\"/Users/pandusetiawan/Documents/react/df-v1.2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/pandusetiawan/Documents/react/df-v1.2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/Users/pandusetiawan/Documents/react/df-v1.2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Users/pandusetiawan/Documents/react/df-v1.2/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React from\"react\";import ExtensionsHeader from\"../extensionsHeader\";import{Row,Col,Card,CardBody,Button,Table,Modal,ModalHeader,ModalBody,ModalFooter,Input,FormGroup,CustomInput}from\"reactstrap\";import classnames from\"classnames\";import XLSX from\"xlsx\";import{Check,Minus,Search}from\"react-feather\";import Checkbox from\"../../components/@vuexy/checkbox/CheckboxesVuexy\";import\"../../assets/scss/pages/import-export.scss\";var Export=/*#__PURE__*/function(_React$Component){_inherits(Export,_React$Component);var _super=_createSuper(Export);function Export(){var _this;_classCallCheck(this,Export);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.state={data:[{'id':1,'name':'Leanne Graham','username':'Bret','email':'Sincere@april.biz','website':'hildegard.org'},{'id':2,'name':'Ervin Howell','username':'Antonette','email':'Shanna@melissa.tv','website':'anastasia.net'},{'id':3,'name':'Clementine Bauch','username':'Samantha','email':'Nathan@yesenia.net','website':'ramiro.info'},{'id':4,'name':'Patricia Lebsack','username':'Karianne','email':'Julianne.OConner@kory.org','website':'kale.biz'},{'id':5,'name':'Chelsey Dietrich','username':'Kamren','email':'Lucio_Hettinger@annie.ca','website':'demarco.info'},{'id':6,'name':'Mrs. Dennis Schulist','username':'Leopoldo_Corkery','email':'Karley_Dach@jasper.info','website':'ola.org'},{'id':7,'name':'Kurtis Weissnat','username':'Elwyn.Skiles','email':'Telly.Hoeger@billy.biz','website':'elvis.io'},{'id':8,'name':'Nicholas Runolfsdottir V','username':'Maxime_Nienow','email':'Sherwood@rosamond.me','website':'jacynthe.com'},{'id':9,'name':'Glenna Reichert','username':'Delphine','email':'Chaim_McDermott@dana.io','website':'conrad.com'},{'id':10,'name':'Clementina DuBuque','username':'Moriah.Stanton','email':'Rey.Padberg@karina.biz','website':'ambrose.net'}],filteredData:[],dataToExport:[],value:\"\",modal:false,fileName:\"\",fileFormat:\"xlsx\",selectedRows:[],selectAll:false};_this.toggleModal=function(){_this.setState({modal:!_this.state.modal});};_this.handleFilter=function(e){var data=_this.state.data;var filteredData=[];var value=e.target.value;_this.setState({value:value});if(value.length){filteredData=data.filter(function(col){var startsWithCondition=col.name.toLowerCase().startsWith(value.toLowerCase())||col.email.toLowerCase().startsWith(value.toLowerCase())||col.website.toLowerCase().startsWith(value.toLowerCase())||col.id.toString().toLowerCase().startsWith(value.toLowerCase());var includesCondition=col.name.toLowerCase().includes(value.toLowerCase())||col.email.toLowerCase().includes(value.toLowerCase())||col.website.toLowerCase().includes(value.toLowerCase())||col.id.toString().toLowerCase().includes(value.toLowerCase());if(startsWithCondition)return startsWithCondition;else if(!startsWithCondition&&includesCondition)return includesCondition;else return null;});_this.setState({value:value,filteredData:filteredData});}};_this.handleExport=function(){_this.toggleModal();var dataToExport=_this.state.dataToExport;_this.state.data.map(function(item){if(_this.state.selectedRows.includes(item.id)){return dataToExport.push(item);}else{return null;}});_this.setState({dataToExport:dataToExport});var fileName=_this.state.fileName.length&&_this.state.fileFormat.length?\"\".concat(_this.state.fileName,\".\").concat(_this.state.fileFormat):\"excel-sheet.xlsx\";var wb=XLSX.utils.json_to_sheet(dataToExport);var wbout=XLSX.utils.book_new();XLSX.utils.book_append_sheet(wbout,wb,'test');XLSX.writeFile(wbout,fileName);};_this.handleSelect=function(id){var selectedRows=_this.state.selectedRows;if(!selectedRows.includes(id)){selectedRows.push(id);}else if(selectedRows.includes(id)){selectedRows.splice(selectedRows.indexOf(id),1);}else{return null;}_this.setState({selectedRows:selectedRows});};_this.handleSelectAll=function(){var selectedRows=_this.state.selectedRows;var data=_this.state.data;if(selectedRows.length<data.length){var ids=data.map(function(i){return i.id;});selectedRows=ids;}else if(selectedRows.length===data.length){selectedRows=[];}else{return null;}_this.setState({selectedRows:selectedRows});};return _this;}_createClass(Export,[{key:\"render\",value:function render(){var _this2=this;var array=this.state.value?this.state.filteredData:this.state.data;var renderTableData=array.map(function(col){return/*#__PURE__*/React.createElement(\"tr\",{key:col.id,className:classnames({selected:_this2.state.selectedRows.includes(col.id)})},/*#__PURE__*/React.createElement(\"td\",null,/*#__PURE__*/React.createElement(Checkbox,{size:\"sm\",color:\"primary\",icon:/*#__PURE__*/React.createElement(Check,{className:\"vx-icon\",size:12}),label:\"\",checked:_this2.state.selectedRows.includes(col.id),onChange:function onChange(){return _this2.handleSelect(col.id);}})),/*#__PURE__*/React.createElement(\"td\",null,col.email),/*#__PURE__*/React.createElement(\"td\",null,col.name),/*#__PURE__*/React.createElement(\"td\",null,col.website),/*#__PURE__*/React.createElement(\"td\",null,col.id));});var IconTag=this.state.selectedRows.length!==this.state.data.length&&this.state.selectedRows.length?Minus:Check;return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(ExtensionsHeader,{title:\"XLSX\",subTitle:\"Xlsx is a parser and writer for various spreadsheet formats\",link:\"https://github.com/AdeleD/react-paginate\"}),/*#__PURE__*/React.createElement(Row,{className:\"export-component\"},/*#__PURE__*/React.createElement(Col,{sm:\"12\"},/*#__PURE__*/React.createElement(Card,null,/*#__PURE__*/React.createElement(CardBody,null,/*#__PURE__*/React.createElement(Row,null,/*#__PURE__*/React.createElement(Col,{sm:\"12\"},/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex flex-wrap justify-content-between\"},/*#__PURE__*/React.createElement(Button.Ripple,{color:\"primary\",onClick:this.toggleModal},\"Export Selected\"),/*#__PURE__*/React.createElement(\"div\",{className:\"filter position-relative has-icon-left\"},/*#__PURE__*/React.createElement(Input,{type:\"text\",value:this.state.value,onChange:function onChange(e){return _this2.handleFilter(e);}}),/*#__PURE__*/React.createElement(\"div\",{className:\"form-control-position\"},/*#__PURE__*/React.createElement(Search,{size:15}))))),/*#__PURE__*/React.createElement(Col,{sm:\"12\"},/*#__PURE__*/React.createElement(Table,{className:\"table-hover-animation mt-2\",responsive:true},/*#__PURE__*/React.createElement(\"thead\",null,/*#__PURE__*/React.createElement(\"tr\",null,/*#__PURE__*/React.createElement(\"th\",null,/*#__PURE__*/React.createElement(Checkbox,{size:\"sm\",color:\"primary\",icon:/*#__PURE__*/React.createElement(IconTag,{className:\"vx-icon\",size:12}),checked:this.state.selectedRows.length,onChange:function onChange(e){return _this2.handleSelectAll();}})),/*#__PURE__*/React.createElement(\"th\",null,\"Email\"),/*#__PURE__*/React.createElement(\"th\",null,\"Name\"),/*#__PURE__*/React.createElement(\"th\",null,\"Website\"),/*#__PURE__*/React.createElement(\"th\",null,\"Rank\"))),/*#__PURE__*/React.createElement(\"tbody\",null,renderTableData)))))))),/*#__PURE__*/React.createElement(Modal,{isOpen:this.state.modal,toggle:this.toggleModal,className:\"modal-dialog-centered\"},/*#__PURE__*/React.createElement(ModalHeader,{toggle:this.toggleModal},\"Export To Excel\"),/*#__PURE__*/React.createElement(ModalBody,null,/*#__PURE__*/React.createElement(FormGroup,null,/*#__PURE__*/React.createElement(Input,{type:\"text\",value:this.state.fileName,onChange:function onChange(e){return _this2.setState({fileName:e.target.value});},placeholder:\"Enter File Name\"})),/*#__PURE__*/React.createElement(FormGroup,null,/*#__PURE__*/React.createElement(CustomInput,{type:\"select\",id:\"selectFileFormat\",name:\"customSelect\",value:this.state.fileFormat,onChange:function onChange(e){return _this2.setState({fileFormat:e.target.value});}},/*#__PURE__*/React.createElement(\"option\",null,\"xlsx\"),/*#__PURE__*/React.createElement(\"option\",null,\"csv\"),/*#__PURE__*/React.createElement(\"option\",null,\"txt\")))),/*#__PURE__*/React.createElement(ModalFooter,null,/*#__PURE__*/React.createElement(Button,{color:\"primary\",onClick:this.handleExport},\"Export\"),/*#__PURE__*/React.createElement(Button,{color:\"flat-danger\",onClick:this.toggleModal},\"Cancel\"))));}}]);return Export;}(React.Component);export default Export;","map":{"version":3,"sources":["/Users/pandusetiawan/Documents/react/df-v1.2/src/extensions/import-export/ExportSelected.js"],"names":["React","ExtensionsHeader","Row","Col","Card","CardBody","Button","Table","Modal","ModalHeader","ModalBody","ModalFooter","Input","FormGroup","CustomInput","classnames","XLSX","Check","Minus","Search","Checkbox","Export","state","data","filteredData","dataToExport","value","modal","fileName","fileFormat","selectedRows","selectAll","toggleModal","setState","handleFilter","e","target","length","filter","col","startsWithCondition","name","toLowerCase","startsWith","email","website","id","toString","includesCondition","includes","handleExport","map","item","push","wb","utils","json_to_sheet","wbout","book_new","book_append_sheet","writeFile","handleSelect","splice","indexOf","handleSelectAll","ids","i","array","renderTableData","selected","IconTag","Component"],"mappings":"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","sourcesContent":["import React from \"react\"\nimport ExtensionsHeader from \"../extensionsHeader\"\nimport {\n  Row,\n  Col,\n  Card,\n  CardBody,\n  Button,\n  Table,\n  Modal,\n  ModalHeader,\n  ModalBody,\n  ModalFooter,\n  Input,\n  FormGroup,\n  CustomInput\n} from \"reactstrap\"\nimport classnames from \"classnames\"\nimport XLSX from \"xlsx\"\nimport { Check, Minus, Search } from \"react-feather\"\nimport Checkbox from \"../../components/@vuexy/checkbox/CheckboxesVuexy\"\n\nimport \"../../assets/scss/pages/import-export.scss\"\nclass Export extends React.Component {\n  state = {\n    data : [\n      {\n        'id': 1,\n        'name': 'Leanne Graham',\n        'username': 'Bret',\n        'email': 'Sincere@april.biz',\n        'website': 'hildegard.org'\n      },\n      {\n        'id': 2,\n        'name': 'Ervin Howell',\n        'username': 'Antonette',\n        'email': 'Shanna@melissa.tv',\n        'website': 'anastasia.net'\n      },\n      {\n        'id': 3,\n        'name': 'Clementine Bauch',\n        'username': 'Samantha',\n        'email': 'Nathan@yesenia.net',\n        'website': 'ramiro.info'\n      },\n      {\n        'id': 4,\n        'name': 'Patricia Lebsack',\n        'username': 'Karianne',\n        'email': 'Julianne.OConner@kory.org',\n        'website': 'kale.biz'\n      },\n      {\n        'id': 5,\n        'name': 'Chelsey Dietrich',\n        'username': 'Kamren',\n        'email': 'Lucio_Hettinger@annie.ca',\n        'website': 'demarco.info'\n      },\n      {\n        'id': 6,\n        'name': 'Mrs. Dennis Schulist',\n        'username': 'Leopoldo_Corkery',\n        'email': 'Karley_Dach@jasper.info',\n        'website': 'ola.org'\n      },\n      {\n        'id': 7,\n        'name': 'Kurtis Weissnat',\n        'username': 'Elwyn.Skiles',\n        'email': 'Telly.Hoeger@billy.biz',\n        'website': 'elvis.io'\n      },\n      {\n        'id': 8,\n        'name': 'Nicholas Runolfsdottir V',\n        'username': 'Maxime_Nienow',\n        'email': 'Sherwood@rosamond.me',\n        'website': 'jacynthe.com'\n      },\n      {\n        'id': 9,\n        'name': 'Glenna Reichert',\n        'username': 'Delphine',\n        'email': 'Chaim_McDermott@dana.io',\n        'website': 'conrad.com'\n      },\n      {\n        'id': 10,\n        'name': 'Clementina DuBuque',\n        'username': 'Moriah.Stanton',\n        'email': 'Rey.Padberg@karina.biz',\n        'website': 'ambrose.net'\n      }\n    ],\n    filteredData : [],\n    dataToExport : [],\n    value : \"\",\n    modal : false,\n    fileName: \"\",\n    fileFormat: \"xlsx\",\n    selectedRows:[],\n    selectAll: false\n  }\n\n  toggleModal = () => {\n    this.setState({ modal : !this.state.modal })\n  }\n\n  handleFilter = e => {\n    let data = this.state.data\n    let filteredData = []\n    let value = e.target.value\n    this.setState({ value })\n    if(value.length){\n      filteredData = data.filter(col => {\n        let startsWithCondition = col.name.toLowerCase().startsWith(value.toLowerCase()) ||\n        col.email.toLowerCase().startsWith(value.toLowerCase()) ||\n        col.website.toLowerCase().startsWith(value.toLowerCase()) ||\n        col.id.toString().toLowerCase().startsWith(value.toLowerCase())\n  \n        let includesCondition = col.name.toLowerCase().includes(value.toLowerCase()) ||\n        col.email.toLowerCase().includes(value.toLowerCase()) ||\n        col.website.toLowerCase().includes(value.toLowerCase()) || \n        col.id.toString().toLowerCase().includes(value.toLowerCase())\n  \n        if(startsWithCondition) return startsWithCondition\n        else if(!startsWithCondition && includesCondition) return includesCondition\n        else return null\n      })\n      this.setState({ value, filteredData })\n    }\n  }\n\n  handleExport = () => {\n    this.toggleModal()\n    let dataToExport = this.state.dataToExport\n    this.state.data.map(item => {\n      if(this.state.selectedRows.includes(item.id)){\n        return dataToExport.push(item)\n      }else{\n        return null\n      }\n    })\n    this.setState({ dataToExport })\n    let fileName =\n      this.state.fileName.length && this.state.fileFormat.length\n        ? `${this.state.fileName}.${this.state.fileFormat}`\n        : \"excel-sheet.xlsx\"\n    let wb = XLSX.utils.json_to_sheet(dataToExport)\n    let wbout = XLSX.utils.book_new();\n    XLSX.utils.book_append_sheet(wbout, wb, 'test')\n    XLSX.writeFile(wbout, fileName);\n  }\n\n  handleSelect = id => {\n    let selectedRows = this.state.selectedRows\n    if(!selectedRows.includes(id)){\n      selectedRows.push(id)\n    }else if(selectedRows.includes(id)){\n      selectedRows.splice(selectedRows.indexOf(id), 1)\n    }else{\n      return null\n    }\n    this.setState({ selectedRows })\n  }\n\n  handleSelectAll = () => {\n    let selectedRows = this.state.selectedRows\n    let data = this.state.data\n    if(selectedRows.length < data.length){\n      let ids = data.map(i => i.id)\n      selectedRows = ids\n    }\n    else if (selectedRows.length === data.length){\n      selectedRows = []\n    }else{\n      return null\n    }\n\n    this.setState({ selectedRows })\n  }\n  \n  render() {\n    let array = this.state.value ? this.state.filteredData : this.state.data\n    let renderTableData = array.map(col => {\n      return <tr key={col.id} className={classnames({\n        selected : this.state.selectedRows.includes(col.id)\n      })}>\n        <td>\n          <Checkbox\n            size=\"sm\"\n            color=\"primary\"\n            icon={<Check className=\"vx-icon\" size={12} />}\n            label=\"\"\n            checked={this.state.selectedRows.includes(col.id)}\n            onChange={() => this.handleSelect(col.id)}\n          />\n        </td>\n        <td>{col.email}</td>\n        <td>{col.name}</td>\n        <td>{col.website}</td>\n        <td>{col.id}</td>\n      </tr>\n    })\n    let IconTag = this.state.selectedRows.length !== this.state.data.length && this.state.selectedRows.length ? Minus : Check\n    return (\n      <React.Fragment>\n        <ExtensionsHeader\n          title=\"XLSX\"\n          subTitle=\"Xlsx is a parser and writer for various spreadsheet formats\"\n          link=\"https://github.com/AdeleD/react-paginate\"\n        />\n        <Row className=\"export-component\">\n          <Col sm=\"12\">\n            <Card>\n              <CardBody>\n                <Row>\n                  <Col sm=\"12\">\n                    <div className=\"d-flex flex-wrap justify-content-between\">\n                      <Button.Ripple color=\"primary\" onClick={this.toggleModal}>\n                        Export Selected\n                      </Button.Ripple>\n                     <div className=\"filter position-relative has-icon-left\">\n                        <Input type=\"text\" value={this.state.value} onChange={e => this.handleFilter(e)} />\n                        <div className=\"form-control-position\">\n                          <Search size={15} />\n                        </div>\n                     </div>\n                    </div>\n                  </Col>\n                  <Col sm=\"12\">\n                    <Table\n                      className=\"table-hover-animation mt-2\"\n                      responsive\n                    >\n                      <thead>\n                        <tr>\n                          <th>\n                            <Checkbox\n                              size=\"sm\"\n                              color=\"primary\"\n                              icon={<IconTag className=\"vx-icon\" size={12} />}\n                              checked={this.state.selectedRows.length}\n                              onChange={e => this.handleSelectAll()}\n                            />\n                          </th>\n                          <th>Email</th>\n                          <th>Name</th>\n                          <th>Website</th>\n                          <th>Rank</th>\n                        </tr>\n                      </thead>\n                      <tbody>\n                        {renderTableData}\n                      </tbody>\n                    </Table>\n                  </Col>\n                </Row>\n              </CardBody>\n            </Card>\n          </Col>\n        </Row>\n        <Modal\n          isOpen={this.state.modal}\n          toggle={this.toggleModal}\n          className=\"modal-dialog-centered\"\n        >\n          <ModalHeader toggle={this.toggleModal}>Export To Excel</ModalHeader>\n          <ModalBody>\n            <FormGroup>\n              <Input \n                type=\"text\" \n                value={this.state.fileName} \n                onChange={e => this.setState({fileName : e.target.value})} \n                placeholder=\"Enter File Name\" \n              />\n            </FormGroup>\n            <FormGroup>\n              <CustomInput \n                type=\"select\" \n                id=\"selectFileFormat\" \n                name=\"customSelect\"\n                value={this.state.fileFormat}\n                onChange={e => this.setState({ fileFormat : e.target.value })}\n              >\n                <option>xlsx</option>\n                <option>csv</option>\n                <option>txt</option>\n              </CustomInput>\n            </FormGroup>\n          </ModalBody>\n          <ModalFooter>\n            <Button color=\"primary\" onClick={this.handleExport}>\n              Export\n            </Button>\n            <Button color=\"flat-danger\" onClick={this.toggleModal}>\n              Cancel\n            </Button>\n          </ModalFooter>\n        </Modal>\n      </React.Fragment>\n    )\n  }\n}\n\nexport default Export\n"]},"metadata":{},"sourceType":"module"}