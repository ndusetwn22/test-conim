{"ast":null,"code":"import _defineProperty from\"/Users/pandusetiawan/Documents/react/df-v1.3 backup build/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _regeneratorRuntime from\"/Users/pandusetiawan/Documents/react/df-v1.3 backup build/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/pandusetiawan/Documents/react/df-v1.3 backup build/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"/Users/pandusetiawan/Documents/react/df-v1.3 backup build/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/pandusetiawan/Documents/react/df-v1.3 backup build/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/Users/pandusetiawan/Documents/react/df-v1.3 backup build/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Users/pandusetiawan/Documents/react/df-v1.3 backup build/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React from\"react\";import{api_query}from\"../../../api/ApiConstant\";import{Row,Col,Card,CardBody,CardHeader,CardTitle,Badge,FormGroup,Input,Button,Label,Modal,ModalHeader,ModalBody,ModalFooter,Alert}from\"reactstrap\";import Select from\"react-select\";import DataTable from\"react-data-table-component\";import{Star,Search,Edit,Trash,ChevronDown,Plus,Check,ChevronLeft,ChevronRight}from\"react-feather\";import axios from'axios';import{history}from\"../../../../src/history\";import Toggle from\"react-toggle\";import SweetAlert from\"react-bootstrap-sweetalert\";var CustomHeader=function CustomHeader(props){return/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex flex-wrap justify-content-between\"},/*#__PURE__*/React.createElement(\"div\",{className:\"add-new\"},/*#__PURE__*/React.createElement(Button.Ripple,{color:\"none\",className:\"bg-gradient-success\",onClick:function onClick(){return props.departemenAdd();}},\"Tambah Departemen\")),/*#__PURE__*/React.createElement(\"div\",{className:\"position-relative has-icon-left mb-1\"},/*#__PURE__*/React.createElement(Input,{value:props.value,onChange:function onChange(e){return props.handleFilter(e);}}),/*#__PURE__*/React.createElement(\"div\",{className:\"form-control-position\"},/*#__PURE__*/React.createElement(Search,{size:\"15\"}))));};var ActionsComponent=function ActionsComponent(props){return/*#__PURE__*/React.createElement(\"div\",{className:\"data-list-action\"},/*#__PURE__*/React.createElement(Button.Ripple,{className:\"mr-1 bg-gradient-success\",color:\"none\",size:\"sm\",onClick:function onClick(){// console.log('props : ', props);\nreturn props.isView(props.row,props.row.id,props.row.cff_id);}},\"View\"));};var DepartemenTable=/*#__PURE__*/function(_React$Component){_inherits(DepartemenTable,_React$Component);var _super=_createSuper(DepartemenTable);function DepartemenTable(){var _this;_classCallCheck(this,DepartemenTable);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.state={modalVisible:false,modalImage:'',modalDigimonName:'',myProfile:null,modal:false,modalAdd:false,id:0,namaDepartemen:'',namaDepartemenAdd:'',isSweetAlert:false,sweetAlertTitle:'Judul',sweetAlertText:'Text',sweetAlertType:'warning',isSweetAlertConfirm:false,sweetAlertTitleConfirm:'Judul',sweetAlertTextConfirm:'Text',sweetAlertTypeConfirm:'warning',columns:[{name:\"Id\",selector:\"id\",sortable:true,minWidth:\"200px\",cell:function cell(row){return/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex flex-xl-row flex-column align-items-xl-center align-items-start py-xl-0 py-1\"},/*#__PURE__*/React.createElement(\"div\",{className:\"user-info text-truncate ml-xl-50 ml-0\"},/*#__PURE__*/React.createElement(\"span\",{title:row.id,className:\"d-block text-bold-500 text-truncate mb-0\"},row.id)));}},{name:\"Nama Departemen\",selector:\"nama_departemen\",sortable:true,minWidth:\"200px\",cell:function cell(row){return/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex flex-xl-row flex-column align-items-xl-center align-items-start py-xl-0 py-1\"},/*#__PURE__*/React.createElement(\"div\",{className:\"user-info text-truncate ml-xl-50 ml-0\"},/*#__PURE__*/React.createElement(\"span\",{title:row.nama_departemen,className:\"d-block text-bold-500 text-truncate mb-0\"},row.nama_departemen)));}},{name:\"Actions\",sortable:true,cell:function cell(row){return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(ActionsComponent,{row:row,isView:_this.toggleModal}));}}],data:[],filteredData:[],value:\"\"};_this.componentDidMount=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return _this.isLogin('super_admin');case 2:_context.next=4;return _this.tarikDataTable();case 4:case\"end\":return _context.stop();}}},_callee);}));_this.departemenAdd=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:console.log('Depatemen Add');_context2.next=3;return _this.toggleModalAdd();case 3:case\"end\":return _context2.stop();}}},_callee2);}));_this.toggleModalAdd=function(data,id){// this.setState(prevState => ({\n//   modal: !prevState.modal\n// }))\n_this.setState(function(prevState){return{modalAdd:!prevState.modalAdd};});};_this.toggleModalAddFix=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(){var sql,result;return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:_this.setState(function(prevState){return{modalAdd:!prevState.modalAdd};});sql=\"\\n        insert into df_master_departement(nama_departemen)\\n        values('\"+_this.state.namaDepartemenAdd+\"')\\n    \";// console.log('sql : ', sql)\n_context5.next=4;return axios.post(api_query,{query:sql}).then(/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(result){var res;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:res=result.data.response;// Beda dgn sweetAlert yg lain\n_context3.next=3;return _this.handleAlertConfirm('isSweetAlertConfirm',true,'Success','Berhasil tambah departemen','success');case 3:return _context3.abrupt(\"return\",_context3.sent);case 4:case\"end\":return _context3.stop();}}},_callee3);}));return function(_x){return _ref4.apply(this,arguments);};}()).catch(/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(err){return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:console.log('error : ',err);_context4.next=3;return _this.handleAlertConfirm('isSweetAlertConfirm',true,'Danger','Gagal tambah nama departemen','danger');case 3:return _context4.abrupt(\"return\",_context4.sent);case 4:case\"end\":return _context4.stop();}}},_callee4);}));return function(_x2){return _ref5.apply(this,arguments);};}());case 4:result=_context5.sent;case 5:case\"end\":return _context5.stop();}}},_callee5);}));_this.toggleModal=function(data,id){// this.setState(prevState => ({\n//   modal: !prevState.modal\n// }))\n_this.setState(function(prevState){return{modal:!prevState.modal,namaDepartemen:data.nama_departemen,id:data.id};});};_this.toggleModalFix=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee8(){var sql,result;return _regeneratorRuntime.wrap(function _callee8$(_context8){while(1){switch(_context8.prev=_context8.next){case 0:_this.setState(function(prevState){return{modal:!prevState.modal};});sql=\"\\n        update df_master_departement\\n        set\\n        nama_departemen = '\"+_this.state.namaDepartemen+\"',\\n        update_date = timezone('utc-7', now())\\n        where id = \"+_this.state.id+\"\\n    \";// console.log('sql : ', sql)\n_context8.next=4;return axios.post(api_query,{query:sql}).then(/*#__PURE__*/function(){var _ref7=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee6(result){var res;return _regeneratorRuntime.wrap(function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:res=result.data.response;// Beda dgn sweetAlert yg lain\n_context6.next=3;return _this.handleAlertConfirm('isSweetAlertConfirm',true,'Success','Berhasil ganti nama departemen','success');case 3:return _context6.abrupt(\"return\",_context6.sent);case 4:case\"end\":return _context6.stop();}}},_callee6);}));return function(_x3){return _ref7.apply(this,arguments);};}()).catch(/*#__PURE__*/function(){var _ref8=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee7(err){return _regeneratorRuntime.wrap(function _callee7$(_context7){while(1){switch(_context7.prev=_context7.next){case 0:console.log('error : ',err);_context7.next=3;return _this.handleAlertConfirm('isSweetAlertConfirm',true,'Danger','Gagal ganti nama departemen','danger');case 3:return _context7.abrupt(\"return\",_context7.sent);case 4:case\"end\":return _context7.stop();}}},_callee7);}));return function(_x4){return _ref8.apply(this,arguments);};}());case 4:result=_context8.sent;case 5:case\"end\":return _context8.stop();}}},_callee8);}));_this.handleAlertConfirm=/*#__PURE__*/function(){var _ref9=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee9(state,value,title,text,type){return _regeneratorRuntime.wrap(function _callee9$(_context9){while(1){switch(_context9.prev=_context9.next){case 0:if(!value){_context9.next=5;break;}_this.setState(_defineProperty({},state,value));_this.setState({sweetAlertTitleConfirm:title,sweetAlertTextConfirm:text,sweetAlertTypeConfirm:type});_context9.next=8;break;case 5:_this.setState(_defineProperty({},state,value));_context9.next=8;return _this.tarikDataTable();case 8:case\"end\":return _context9.stop();}}},_callee9);}));return function(_x5,_x6,_x7,_x8,_x9){return _ref9.apply(this,arguments);};}();_this.handleAlert=function(state,value,title,text,type){if(value){_this.setState(_defineProperty({},state,value));_this.setState({sweetAlertTitle:title,sweetAlertText:text,sweetAlertType:type});}else{_this.setState(_defineProperty({},state,value));}};_this.isLogin=/*#__PURE__*/function(){var _ref10=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee10(role){var myProfile;return _regeneratorRuntime.wrap(function _callee10$(_context10){while(1){switch(_context10.prev=_context10.next){case 0:if(localStorage.getItem('account')==undefined||localStorage.getItem('account')==null){history.push(\"/pages/login\");}else if(JSON.parse(localStorage.getItem('account')).role!==role){history.push(\"/pages/login\");}else{myProfile=JSON.parse(localStorage.getItem('account'));console.log('myProfile',myProfile);_this.setState({myProfile:myProfile});}case 1:case\"end\":return _context10.stop();}}},_callee10);}));return function(_x10){return _ref10.apply(this,arguments);};}();_this.tarikDataTable=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee12(){var sql,result;return _regeneratorRuntime.wrap(function _callee12$(_context12){while(1){switch(_context12.prev=_context12.next){case 0:sql=\"\\n        select * from df_master_departement order by id asc\\n    \";_context12.next=3;return axios.post(api_query,{query:sql}).then(/*#__PURE__*/function(){var _ref12=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee11(result){var res;return _regeneratorRuntime.wrap(function _callee11$(_context11){while(1){switch(_context11.prev=_context11.next){case 0:// let res = result.data.response\nres=result.data.response.rows;// console.log('result : ', result)\n// console.log('result postgres : ', result)\nconsole.log('result query : ',res);console.log('query leng :',res.length);if(!(res.length=='')){_context11.next=7;break;}return _context11.abrupt(\"return\",[]);case 7:_this.setState({data:res});case 8:case\"end\":return _context11.stop();}}},_callee11);}));return function(_x11){return _ref12.apply(this,arguments);};}()).catch(function(err){console.log('error : ',err);return[];});case 3:result=_context12.sent;case 4:case\"end\":return _context12.stop();}}},_callee12);}));_this.handleFilter=function(e){var value=e.target.value;var data=_this.state.data;var filteredData=_this.state.filteredData;_this.setState({value:value});if(value.length){filteredData=data.filter(function(item){// console.log('ITEM : ', item)\nvar startsWithCondition=item.id.toLowerCase().startsWith(value.toLowerCase())||item.nama_departemen.toLowerCase().startsWith(value.toLowerCase());// item.name.toLowerCase().startsWith(value.toLowerCase())\n// item.date.toLowerCase().startsWith(value.toLowerCase()) ||\n// item.email.toLowerCase().startsWith(value.toLowerCase()) ||\n// item.revenue.toLowerCase().startsWith(value.toLowerCase()) ||\n// item.status.toLowerCase().startsWith(value.toLowerCase())\nvar includesCondition=item.id.toLowerCase().includes(value.toLowerCase())||item.nama_departemen.toLowerCase().includes(value.toLowerCase());// item.name.toLowerCase().includes(value.toLowerCase())\n// item.date.toLowerCase().includes(value.toLowerCase()) ||\n// item.email.toLowerCase().includes(value.toLowerCase()) ||\n// item.revenue.toLowerCase().includes(value.toLowerCase()) ||\n// item.status.toLowerCase().includes(value.toLowerCase())\nif(startsWithCondition){return startsWithCondition;}else if(!startsWithCondition&&includesCondition){return includesCondition;}else return null;});_this.setState({filteredData:filteredData});}};_this.viewSS=/*#__PURE__*/function(){var _ref13=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee13(data,id,cff_id){return _regeneratorRuntime.wrap(function _callee13$(_context13){while(1){switch(_context13.prev=_context13.next){case 0:// console.log('view SS : ', id)\nconsole.log('data row : ',data);// this.props.changeViewPage('edit', data, id)\ncase 1:case\"end\":return _context13.stop();}}},_callee13);}));return function(_x12,_x13,_x14){return _ref13.apply(this,arguments);};}();return _this;}_createClass(DepartemenTable,[{key:\"render\",value:function render(){var _this2=this;var _this$state=this.state,data=_this$state.data,columns=_this$state.columns,value=_this$state.value,filteredData=_this$state.filteredData;return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(Card,null,/*#__PURE__*/React.createElement(CardHeader,null,/*#__PURE__*/React.createElement(CardTitle,null,\"Departemen\")),/*#__PURE__*/React.createElement(CardBody,{className:\"rdt_Wrapper\"},/*#__PURE__*/React.createElement(DataTable,{className:\"dataTable-custom\",data:value.length?filteredData:data,columns:columns,noHeader:true,pagination:true,subHeader:true,subHeaderComponent:/*#__PURE__*/React.createElement(CustomHeader,{value:value,handleFilter:this.handleFilter,departemenAdd:this.departemenAdd})// <CustomHeader value={value} handleFilter={this.handleFilter} tarikData={this.tarikDataTable}/>\n}))),/*#__PURE__*/React.createElement(Modal,{isOpen:this.state.modal,toggle:this.toggleModal,className:\"modal-dialog-centered\"},/*#__PURE__*/React.createElement(ModalHeader,{toggle:this.toggleModal,className:\"bg-success\"},\"Edit Nama Departemen\"),/*#__PURE__*/React.createElement(ModalBody,{className:\"modal-dialog-centered\"},/*#__PURE__*/React.createElement(Label,{for:\"catatan\"},\"Nama Departemen\"),/*#__PURE__*/React.createElement(Input,{type:\"text\",name:\"catatan\",id:\"catatan\",placeholder:\"Catatan CC\",value:this.state.namaDepartemen,onChange:function onChange(val){return _this2.setState({namaDepartemen:val.target.value});}// required\n})),/*#__PURE__*/React.createElement(ModalFooter,null,/*#__PURE__*/React.createElement(Button,{color:\"success\",onClick:this.toggleModalFix},\"Ganti nama departemen\"),\" \")),/*#__PURE__*/React.createElement(Modal,{isOpen:this.state.modalAdd,toggle:this.toggleModalAdd,className:\"modal-dialog-centered\"},/*#__PURE__*/React.createElement(ModalHeader,{toggle:this.toggleModalAdd,className:\"bg-success\"},\"Tambah Departemen\"),/*#__PURE__*/React.createElement(ModalBody,{className:\"modal-dialog-centered\"},/*#__PURE__*/React.createElement(Label,{for:\"catatan\"},\"Nama Departemen\"),/*#__PURE__*/React.createElement(Input,{type:\"text\",name:\"catatan\",id:\"catatan\",placeholder:\"Nama Departemen\",value:this.state.namaDepartemenAdd,onChange:function onChange(val){return _this2.setState({namaDepartemenAdd:val.target.value});}// required\n})),/*#__PURE__*/React.createElement(ModalFooter,null,/*#__PURE__*/React.createElement(Button,{color:\"success\",onClick:this.toggleModalAddFix},\"Tambah departemen\"),\" \")),/*#__PURE__*/React.createElement(SweetAlert,{type:this.state.sweetAlertType,title:this.state.sweetAlertTitle,show:this.state.isSweetAlert,onConfirm:function onConfirm(){return _this2.handleAlert(\"isSweetAlert\",false);}},/*#__PURE__*/React.createElement(\"p\",{className:\"sweet-alert-text\"},this.state.sweetAlertText)),/*#__PURE__*/React.createElement(SweetAlert,{type:this.state.sweetAlertTypeConfirm,title:this.state.sweetAlertTitleConfirm,show:this.state.isSweetAlertConfirm,onConfirm:function onConfirm(){return _this2.handleAlertConfirm(\"isSweetAlertConfirm\",false);}},/*#__PURE__*/React.createElement(\"p\",{className:\"sweet-alert-text\"},this.state.sweetAlertTextConfirm)));}}]);return DepartemenTable;}(React.Component);export default DepartemenTable;","map":null,"metadata":{},"sourceType":"module"}