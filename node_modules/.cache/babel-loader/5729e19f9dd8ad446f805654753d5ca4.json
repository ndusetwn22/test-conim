{"ast":null,"code":"import _regeneratorRuntime from\"/Users/pandusetiawan/Documents/react/df-v1.3 backup build/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/pandusetiawan/Documents/react/df-v1.3 backup build/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"/Users/pandusetiawan/Documents/react/df-v1.3 backup build/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/pandusetiawan/Documents/react/df-v1.3 backup build/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/Users/pandusetiawan/Documents/react/df-v1.3 backup build/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Users/pandusetiawan/Documents/react/df-v1.3 backup build/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React from\"react\";import{Card,FormGroup,Input,Badge}from\"reactstrap\";import{X,Search}from\"react-feather\";import PerfectScrollbar from\"react-perfect-scrollbar\";import{connect}from\"react-redux\";import{getChats,getContactChats,searchContacts,markSeenAllMessages}from\"../../../redux/actions/chat/index\";import userImg from\"../../../assets/img/portrait/small/avatar-s-11.jpg\";var ChatSidebar=/*#__PURE__*/function(_React$Component){_inherits(ChatSidebar,_React$Component);var _super=_createSuper(ChatSidebar);function ChatSidebar(){var _this;_classCallCheck(this,ChatSidebar);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.state={chatsContacts:[],contacts:[],messages:[],status:null,value:\"\"};_this.getChatContents=function(){_this.props.getChats();_this.props.getContactChats();};_this.handleOnChange=function(e){_this.setState({value:e.target.value});_this.props.searchContacts(e.target.value);};return _this;}_createClass(ChatSidebar,[{key:\"componentDidMount\",value:function(){var _componentDidMount=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return this.getChatContents();case 2:this.setState({chatsContacts:this.props.chat.chatContacts,contacts:this.props.chat.contacts,chats:this.props.chat.chats,status:this.props.chat.status});case 3:case\"end\":return _context.stop();}}},_callee,this);}));function componentDidMount(){return _componentDidMount.apply(this,arguments);}return componentDidMount;}()},{key:\"render\",value:function render(){var _this2=this;var _this$state=this.state,contacts=_this$state.contacts,chatsContacts=_this$state.chatsContacts,chats=_this$state.chats,status=_this$state.status,value=_this$state.value;var contactsArr=value.length?this.props.chat.filteredContacts:contacts;var chatsArr=value.length?this.props.chat.filteredChats:chatsContacts;var renderContacts=contactsArr.length>0?contactsArr.map(function(contact){return/*#__PURE__*/React.createElement(\"li\",{key:contact.uid,onClick:function onClick(){_this2.props.handleActiveChat(contact.uid,contact,chats[contact.uid]);_this2.props.markSeenAllMessages(contact.uid);_this2.props.mainSidebar(false);}},/*#__PURE__*/React.createElement(\"div\",{className:\"pr-1\"},/*#__PURE__*/React.createElement(\"span\",{className:\"avatar avatar-md m-0\"},/*#__PURE__*/React.createElement(\"img\",{src:contact.photoURL,alt:contact.displayName,height:\"38\",width:\"38\"}))),/*#__PURE__*/React.createElement(\"div\",{className:\"user-chat-info\"},/*#__PURE__*/React.createElement(\"div\",{className:\"contact-info\"},/*#__PURE__*/React.createElement(\"h5\",{className:\"text-bold-600 mb-0\"},contact.displayName),/*#__PURE__*/React.createElement(\"p\",{className:\"truncate\"},contact.about))));}):null;var renderChats=chatsArr&&Array.isArray(chatsArr)?chatsArr.map(function(chat){var lastMsg=chats[chat.uid]&&chats[chat.uid].msg?chats[chat.uid].msg.slice(-1)[0]:null,lastMsgDate=new Date(lastMsg&&lastMsg.time?lastMsg.time:null),lastMsgMonth=lastMsgDate.toLocaleString(\"default\",{month:\"short\"}),lastMsgDay=lastMsgDate.getDate();var pendingMsg=chats[chat.uid]&&chats[chat.uid].msg?chats[chat.uid].msg.filter(function(i){return i.isSeen===false&&i.isSent!==true;}).length:null;var activeID=chats[chat.uid]!==undefined?chats[chat.uid]:null;return/*#__PURE__*/React.createElement(\"li\",{key:chat.uid,onClick:function onClick(){_this2.props.handleActiveChat(chat.uid,chat,activeID);_this2.props.mainSidebar(false);_this2.props.markSeenAllMessages(chat.uid);},className:\"\".concat(_this2.props.activeChatID===chat.uid?\"active\":\"\")},/*#__PURE__*/React.createElement(\"div\",{className:\"pr-1\"},/*#__PURE__*/React.createElement(\"span\",{className:\"avatar avatar-md m-0\"},/*#__PURE__*/React.createElement(\"img\",{src:chat.photoURL,alt:chat.displayName,height:\"38\",width:\"38\"}))),/*#__PURE__*/React.createElement(\"div\",{className:\"user-chat-info\"},/*#__PURE__*/React.createElement(\"div\",{className:\"contact-info\"},/*#__PURE__*/React.createElement(\"h5\",{className:\"text-bold-600 mb-0\"},chat.displayName),/*#__PURE__*/React.createElement(\"p\",{className:\"truncate\"},lastMsg?lastMsg.textContent:chat.about)),/*#__PURE__*/React.createElement(\"div\",{className:\"contact-meta d-flex- flex-column\"},/*#__PURE__*/React.createElement(\"span\",{className:\"float-right mb-25\"},lastMsgMonth+\" \"+lastMsgDay),pendingMsg>0?/*#__PURE__*/React.createElement(\"div\",{className:\"unseen-msg\"},/*#__PURE__*/React.createElement(Badge,{className:\"badge-md float-right\",color:\"primary\",pill:true},pendingMsg)):null)));}):null;return/*#__PURE__*/React.createElement(Card,{className:\"sidebar-content h-100\"},/*#__PURE__*/React.createElement(\"span\",{className:\"sidebar-close-icon\",onClick:function onClick(){return _this2.props.mainSidebar(false);}},/*#__PURE__*/React.createElement(X,{size:15})),/*#__PURE__*/React.createElement(\"div\",{className:\"chat-fixed-search\"},/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex align-items-center\"},/*#__PURE__*/React.createElement(\"div\",{className:\"sidebar-profile-toggle position-relative d-inline-flex\"},/*#__PURE__*/React.createElement(\"div\",{className:\"avatar\",onClick:function onClick(){return _this2.props.handleUserSidebar(\"open\");}},/*#__PURE__*/React.createElement(\"img\",{src:userImg,alt:\"User Profile\",height:\"40\",width:\"40\"}),/*#__PURE__*/React.createElement(\"span\",{className:status===\"dnd\"?\"avatar-status-busy\":status===\"away\"?\"avatar-status-away\":status===\"offline\"?\"avatar-status-offline\":\"avatar-status-online\"}))),/*#__PURE__*/React.createElement(FormGroup,{className:\"position-relative has-icon-left mx-1 my-0 w-100\"},/*#__PURE__*/React.createElement(Input,{className:\"round\",type:\"text\",placeholder:\"Search contact or start a new chat\",onChange:function onChange(e){return _this2.handleOnChange(e);},value:value}),/*#__PURE__*/React.createElement(\"div\",{className:\"form-control-position\"},/*#__PURE__*/React.createElement(Search,{size:15}))))),/*#__PURE__*/React.createElement(PerfectScrollbar,{className:\"chat-user-list list-group\",options:{wheelPropagation:false}},/*#__PURE__*/React.createElement(\"h3\",{className:\"primary p-1 mb-0\"},\"Chats\"),/*#__PURE__*/React.createElement(\"ul\",{className:\"chat-users-list-wrapper media-list\"},renderChats),/*#__PURE__*/React.createElement(\"h3\",{className:\"primary p-1 mb-0\"},\"Contacts\"),/*#__PURE__*/React.createElement(\"ul\",{className:\"chat-users-list-wrapper media-list\"},renderContacts)));}}],[{key:\"getDerivedStateFromProps\",value:function getDerivedStateFromProps(props,state){if(props.chat.chatContacts.length!==state.chatContacts||props.chat.contacts.length!==state.contacts||props.chat.chats.length!==state.chats||props.chat.status!==state.status){return{chatsContacts:props.chat.chatContacts,contacts:props.chat.contacts,chats:props.chat.chats,status:props.chat.status};}// Return null if the state hasn't changed\nreturn null;}}]);return ChatSidebar;}(React.Component);var mapStateToProps=function mapStateToProps(state){return{chat:state.chatApp.chats};};export default connect(mapStateToProps,{getChats:getChats,getContactChats:getContactChats,searchContacts:searchContacts,markSeenAllMessages:markSeenAllMessages})(ChatSidebar);","map":null,"metadata":{},"sourceType":"module"}