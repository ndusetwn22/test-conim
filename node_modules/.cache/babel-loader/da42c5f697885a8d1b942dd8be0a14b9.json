{"ast":null,"code":"import _defineProperty from\"/Users/pandusetiawan/Documents/react/df-v1.3 backup build/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _regeneratorRuntime from\"/Users/pandusetiawan/Documents/react/df-v1.3 backup build/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/pandusetiawan/Documents/react/df-v1.3 backup build/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"/Users/pandusetiawan/Documents/react/df-v1.3 backup build/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/pandusetiawan/Documents/react/df-v1.3 backup build/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/Users/pandusetiawan/Documents/react/df-v1.3 backup build/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Users/pandusetiawan/Documents/react/df-v1.3 backup build/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React from\"react\";import{api_query,project}from\"../../../../api/ApiConstant\";import firebase from\"../../../../firebase/firebase\";import axios from'axios';import{Card,CardHeader,CardTitle,CardBody,FormGroup,Row,Col,Input,Form,Button,Label,CustomInput,CardImg}from\"reactstrap\";import img1 from\"../../../../assets/img/pages/1.png\";import img2 from\"../../../../assets/img/pages/2.png\";import Checkbox from\"../../../../components/@vuexy/checkbox/CheckboxesVuexy\";import{Check,Star,Save,Send}from\"react-feather\";import{history}from\"../../../../../src/history\";import Select from\"react-select\";import SweetAlert from\"react-bootstrap-sweetalert\";import Spinner from\"../../../../components/@vuexy/spinner/Fallback-spinner\";import Toggle from\"react-toggle\";import\"react-toggle/style.css\";import\"../../../../assets/scss/plugins/forms/switch/react-toggle.scss\";var KaryawanAdd=/*#__PURE__*/function(_React$Component){_inherits(KaryawanAdd,_React$Component);var _super=_createSuper(KaryawanAdd);function KaryawanAdd(props){var _this;_classCallCheck(this,KaryawanAdd);_this=_super.call(this,props);_this.componentDidMount=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return _this.isLogin(\"super_admin\");case 2:_context.next=4;return _this.tarikDepartemen();case 4:case\"end\":return _context.stop();}}},_callee);}));_this.submitForm=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee6(){var active,pass,role,sql,result;return _regeneratorRuntime.wrap(function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:if(!(_this.state.nik==''||_this.state.nik==null)){_context6.next=4;break;}_context6.next=3;return _this.handleAlert('isSweetAlert',true,'Warning','NIK Tidak Boleh Kosong','warning');case 3:return _context6.abrupt(\"return\",_context6.sent);case 4:if(!(_this.state.nama==''||_this.state.nama==null)){_context6.next=8;break;}_context6.next=7;return _this.handleAlert('isSweetAlert',true,'Warning','Nama Lengkap Tidak Boleh Kosong','warning');case 7:return _context6.abrupt(\"return\",_context6.sent);case 8:if(!(_this.state.jobLevel==''||_this.state.jobLevel==null)){_context6.next=12;break;}_context6.next=11;return _this.handleAlert('isSweetAlert',true,'Warning','Job Level Tidak Boleh Kosong','warning');case 11:return _context6.abrupt(\"return\",_context6.sent);case 12:if(!(_this.state.departementSelected==''||_this.state.departementSelected==null)){_context6.next=18;break;}_context6.next=15;return _this.handleAlert('isSweetAlert',true,'Warning','Departemen Tidak Boleh Kosong','warning');case 15:return _context6.abrupt(\"return\",_context6.sent);case 18:_this.setState({isLoading:true});active=_this.state.isChecked?'Y':'N';pass='onekalbe21';role='op_df';if(_this.state.jobLevel=='1'||_this.state.jobLevel=='2'||_this.state.jobLevel=='3'){role='op_df';}if(_this.state.jobLevel=='4'){role='spv_df';}if(_this.state.jobLevel=='5'){role='spv_df';}//besok cek NIK dulu\nsql=\"\\n           select id, nik from df_master_user where nik = '\"+_this.state.nik+\"'\\n        \";// console.log('sql : ', sql)\n_context6.next=28;return axios.post(api_query,{query:sql}).then(/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(result){var res,sql2,result2;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:res=result.data.response.rows;if(!(res.length=='')){_context4.next=8;break;}// query insert\nsql2=\"\\n                                        INSERT INTO df_master_user\\n                                        (nik, name, password, role, job_level, departement_id, active)\\n                                        VALUES('\"+_this.state.nik+\"', '\"+_this.state.nama+\"', df_encrypt('\"+pass+\"'), '\"+role+\"', '\"+_this.state.jobLevel+\"', \"+_this.state.departementSelected+\", '\"+active+\"')\\n                                       \";_context4.next=5;return axios.post(api_query,{query:sql2}).then(/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(result){var res2;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:res2=result.data.response.rows;_context2.next=3;return _this.handleAlertConfirm('isSweetAlertConfirm',true,'Success','Berhasil tambah karyawan','success');case 3:return _context2.abrupt(\"return\",_context2.sent);case 4:case\"end\":return _context2.stop();}}},_callee2);}));return function(_x2){return _ref4.apply(this,arguments);};}()).catch(/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(err){return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:console.log('error: ',err);_context3.next=3;return _this.handleAlertConfirm('isSweetAlertConfirm',true,'Danger','Gagal tambah karyawan','danger');case 3:return _context3.abrupt(\"return\",_context3.sent);case 4:case\"end\":return _context3.stop();}}},_callee3);}));return function(_x3){return _ref5.apply(this,arguments);};}());case 5:result2=_context4.sent;_context4.next=11;break;case 8:_context4.next=10;return _this.handleAlertConfirm('isSweetAlertConfirm',true,'Warning','NIK Sudah digunakan','warning');case 10:return _context4.abrupt(\"return\",_context4.sent);case 11:case\"end\":return _context4.stop();}}},_callee4);}));return function(_x){return _ref3.apply(this,arguments);};}()).catch(/*#__PURE__*/function(){var _ref6=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(err){return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:console.log('error : ',err);_context5.next=3;return _this.handleAlertConfirm('isSweetAlertConfirm',true,'Danger','Gagal tambah karyawan','danger');case 3:return _context5.abrupt(\"return\",_context5.sent);case 4:case\"end\":return _context5.stop();}}},_callee5);}));return function(_x4){return _ref6.apply(this,arguments);};}());case 28:result=_context6.sent;_this.setState({isLoading:false});case 30:case\"end\":return _context6.stop();}}},_callee6);}));_this.tarikDepartemen=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee8(){var sql,result;return _regeneratorRuntime.wrap(function _callee8$(_context8){while(1){switch(_context8.prev=_context8.next){case 0:sql=\"\\n      select  id as value,\\n              nama_departemen as label\\n      from df_master_departement\\n    \";_context8.next=3;return axios.post(api_query,{query:sql}).then(/*#__PURE__*/function(){var _ref8=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee7(result){var res;return _regeneratorRuntime.wrap(function _callee7$(_context7){while(1){switch(_context7.prev=_context7.next){case 0:res=result.data.response.rows;//   console.log('result query kategori : ', res)\nif(!(res.length=='')){_context7.next=3;break;}return _context7.abrupt(\"return\",[]);case 3:_context7.next=5;return _this.setState({dataDepartement:res});case 5:case\"end\":return _context7.stop();}}},_callee7);}));return function(_x5){return _ref8.apply(this,arguments);};}()).catch(function(err){console.log('error : ',err);return[];});case 3:result=_context8.sent;case 4:case\"end\":return _context8.stop();}}},_callee8);}));_this.isLogin=/*#__PURE__*/function(){var _ref9=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee9(role){var myProfile;return _regeneratorRuntime.wrap(function _callee9$(_context9){while(1){switch(_context9.prev=_context9.next){case 0:if(localStorage.getItem('account')==undefined||localStorage.getItem('account')==null){history.push(\"/pages/login\");}else if(JSON.parse(localStorage.getItem('account')).role!==role){history.push(\"/pages/login\");}else{myProfile=JSON.parse(localStorage.getItem('account'));console.log('myProfile ss : ',myProfile);_this.setState({myProfile:myProfile});}case 1:case\"end\":return _context9.stop();}}},_callee9);}));return function(_x6){return _ref9.apply(this,arguments);};}();_this.handleAlertConfirm=function(state,value,title,text,type){if(value){_this.setState(_defineProperty({},state,value));_this.setState({sweetAlertTitleConfirm:title,sweetAlertTextConfirm:text,sweetAlertTypeConfirm:type});}else{_this.setState(_defineProperty({},state,value));_this.props.changeViewPage('page');}// if(text == \"Berhasil membuat SS\"){\n//   this.setState({ [state] : value })\n//   this.setState({sweetAlertTitle: title, sweetAlertText: text, sweetAlertType: type});\n//   // this.props.changeViewPage('page')\n// }else{}\n};_this.handleAlert=function(state,value,title,text,type){if(value){_this.setState(_defineProperty({},state,value));_this.setState({sweetAlertTitle:title,sweetAlertText:text,sweetAlertType:type});}else{_this.setState(_defineProperty({},state,value));}};_this.state={myProfile:null,isSweetAlert:false,sweetAlertTitle:'Judul',sweetAlertText:'Text',sweetAlertType:'warning',isSweetAlertConfirm:false,sweetAlertTitleConfirm:'Judul',sweetAlertTextConfirm:'Text',sweetAlertTypeConfirm:'warning',dataDepartement:[],departementSelected:null,nik:'',nama:'',jobLevel:'1',isChecked:true};return _this;}_createClass(KaryawanAdd,[{key:\"render\",value:function render(){var _this2=this;return/*#__PURE__*/React.createElement(React.Fragment,null,this.state.isLoading?/*#__PURE__*/React.createElement(Spinner,null):/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(Button.Ripple,{color:\"none\",className:\"bg-gradient-warning mb-1\",onClick:function onClick(){return _this2.props.changeViewPage();}},\"Back\"),/*#__PURE__*/React.createElement(Card,null,/*#__PURE__*/React.createElement(CardHeader,null,/*#__PURE__*/React.createElement(CardTitle,null,\"Tambah Karyawan\")),/*#__PURE__*/React.createElement(CardBody,null,/*#__PURE__*/React.createElement(Form,null,/*#__PURE__*/React.createElement(Row,null,/*#__PURE__*/React.createElement(Col,{sm:\"12\"},/*#__PURE__*/React.createElement(FormGroup,null,/*#__PURE__*/React.createElement(Label,{for:\"ssTema\"},\"NIK\"),/*#__PURE__*/React.createElement(Input,{type:\"text\",name:\"nik\",id:\"nik\",placeholder:\"NIK\",value:this.state.nik,onChange:function onChange(val){return _this2.setState({nik:val.target.value});}}))),/*#__PURE__*/React.createElement(Col,{sm:\"12\"},/*#__PURE__*/React.createElement(FormGroup,null,/*#__PURE__*/React.createElement(Label,{for:\"ssTema\"},\"Nama Lengkap\"),/*#__PURE__*/React.createElement(Input,{type:\"text\",name:\"nama\",id:\"nama\",placeholder:\"Nama Lengkap\",value:this.state.nama,onChange:function onChange(val){return _this2.setState({nama:val.target.value});}}))),/*#__PURE__*/React.createElement(Col,{sm:\"12\"},/*#__PURE__*/React.createElement(FormGroup,null,/*#__PURE__*/React.createElement(Label,{for:\"\"},\"Pilih Departemen\"),/*#__PURE__*/React.createElement(Select,{className:\"React\",classNamePrefix:\"select\",name:\"clear\",options:this.state.dataDepartement,onChange:function onChange(val){return _this2.setState({departementSelected:val.value});}}))),/*#__PURE__*/React.createElement(Col,{sm:\"12\"},/*#__PURE__*/React.createElement(FormGroup,null,/*#__PURE__*/React.createElement(Label,{for:\"ssTema\"},\"Job Level\"),/*#__PURE__*/React.createElement(Input,{type:\"text\",name:\"jobLevel\",id:\"jobLevel\",placeholder:\"Job Level (1 - 5)\",value:this.state.jobLevel,onChange:function onChange(val){return _this2.setState({jobLevel:val.target.value});}// disabled\n}))),/*#__PURE__*/React.createElement(Col,{sm:\"3\"},/*#__PURE__*/React.createElement(FormGroup,null,/*#__PURE__*/React.createElement(\"label\",{className:\"react-toggle-wrapper\"},\"Status Aktif Karyawan :\",/*#__PURE__*/React.createElement(Toggle,{checked:this.state.isChecked,onChange:function onChange(){return _this2.setState({isChecked:!_this2.state.isChecked});},name:\"controlledSwitch\",className:\"ml-1\"})))),/*#__PURE__*/React.createElement(Col,{sm:\"12\"},/*#__PURE__*/React.createElement(FormGroup,null,/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex flex-wrap justify-content-end\"},/*#__PURE__*/React.createElement(\"div\",{className:\"justify-content-end\"},/*#__PURE__*/React.createElement(Button,{color:\"none\",className:\"bg-gradient-success\",onClick:function onClick(){return _this2.submitForm();}},/*#__PURE__*/React.createElement(\"span\",{className:\"align-middle ml-25\"},\"Buat Karyawan  \"),/*#__PURE__*/React.createElement(Send,{size:14}))))))))))),/*#__PURE__*/React.createElement(SweetAlert,{type:this.state.sweetAlertType,title:this.state.sweetAlertTitle,show:this.state.isSweetAlert,onConfirm:function onConfirm(){return _this2.handleAlert(\"isSweetAlert\",false);}},/*#__PURE__*/React.createElement(\"p\",{className:\"sweet-alert-text\"},this.state.sweetAlertText)),/*#__PURE__*/React.createElement(SweetAlert,{type:this.state.sweetAlertTypeConfirm,title:this.state.sweetAlertTitleConfirm,show:this.state.isSweetAlertConfirm,onConfirm:function onConfirm(){return _this2.handleAlertConfirm(\"isSweetAlertConfirm\",false);}},/*#__PURE__*/React.createElement(\"p\",{className:\"sweet-alert-text\"},this.state.sweetAlertTextConfirm)));}}]);return KaryawanAdd;}(React.Component);export default KaryawanAdd;","map":null,"metadata":{},"sourceType":"module"}