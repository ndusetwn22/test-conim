{"ast":null,"code":"import _classCallCheck from\"/Users/pandusetiawan/Documents/react/df-v1.3 backup build/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/pandusetiawan/Documents/react/df-v1.3 backup build/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/Users/pandusetiawan/Documents/react/df-v1.3 backup build/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Users/pandusetiawan/Documents/react/df-v1.3 backup build/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React from\"react\";import ReactDOM from\"react-dom\";import{Input,Button}from\"reactstrap\";import{MessageSquare,Menu,Star,Send}from\"react-feather\";import PerfectScrollbar from\"react-perfect-scrollbar\";import{connect}from\"react-redux\";import{togglePinned,sendMessage}from\"../../../redux/actions/chat/index\";import userImg from\"../../../assets/img/portrait/small/avatar-s-11.jpg\";var ChatLog=/*#__PURE__*/function(_React$Component){_inherits(ChatLog,_React$Component);var _super=_createSuper(ChatLog);function ChatLog(){var _this;_classCallCheck(this,ChatLog);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.state={msg:\"\",activeUser:null,activeChat:null};_this.handleSendMessage=function(id,isPinned,text){if(text.length>0){_this.props.sendMessage(id,isPinned,text);_this.setState({msg:\"\"});}};_this.handleTime=function(time_to,time_from){var date_time_to=new Date(Date.parse(time_to));var date_time_from=new Date(Date.parse(time_from));return date_time_to.getFullYear()===date_time_from.getFullYear()&&date_time_to.getMonth()===date_time_from.getMonth()&&date_time_to.getDate()===date_time_from.getDate();};_this.scrollToBottom=function(){var chatContainer=ReactDOM.findDOMNode(_this.chatArea);chatContainer.scrollTop=chatContainer.scrollHeight;};return _this;}_createClass(ChatLog,[{key:\"componentDidMount\",value:function componentDidMount(){this.scrollToBottom();}},{key:\"componentDidUpdate\",value:function componentDidUpdate(){this.scrollToBottom();}},{key:\"render\",value:function render(){var _this2=this;var activeUser=this.state.activeUser;var activeUserUid=activeUser&&activeUser.uid?activeUser.uid:null,activeChat=activeUser&&activeUser.uid?this.props.chat.chats[activeUserUid]:null;var renderChats=activeChat&&activeChat!==undefined&&activeChat.msg?activeChat.msg.map(function(chat,i){var renderSentTime=function renderSentTime(){if(i>0&&!_this2.handleTime(chat.time,activeChat.msg[i-1].time)){return/*#__PURE__*/React.createElement(\"div\",{className:\"divider\"},/*#__PURE__*/React.createElement(\"div\",{className:\"divider-text\"},new Date().getDate()+\" \"+new Date().toLocaleString(\"default\",{month:\"short\"})));}};var renderAvatar=function renderAvatar(){if(i>0){if(chat.isSent===true&&activeChat.msg[i-1].isSent!==true){return/*#__PURE__*/React.createElement(\"div\",{className:\"chat-avatar\"},/*#__PURE__*/React.createElement(\"div\",{className:\"avatar m-0\"},/*#__PURE__*/React.createElement(\"img\",{src:userImg,alt:\"chat avatar\",height:\"40\",width:\"40\"})));}else if(chat.isSent!==true){return/*#__PURE__*/React.createElement(\"div\",{className:\"chat-avatar\"},/*#__PURE__*/React.createElement(\"div\",{className:\"avatar m-0\"},/*#__PURE__*/React.createElement(\"img\",{src:activeUser.photoURL,alt:\"chat avatar\",height:\"40\",width:\"40\"})));}else{return\"\";}}else{return/*#__PURE__*/React.createElement(\"div\",{className:\"chat-avatar\"},/*#__PURE__*/React.createElement(\"div\",{className:\"avatar m-0\"},/*#__PURE__*/React.createElement(\"img\",{src:chat.isSent?userImg:activeUser.photoURL,alt:\"chat avatar\",height:\"40\",width:\"40\"})));}};return/*#__PURE__*/React.createElement(React.Fragment,{key:i},renderSentTime(),/*#__PURE__*/React.createElement(\"div\",{className:\"chat \".concat(chat.isSent!==true?\"chat-left\":\"chat-right\")},renderAvatar(),/*#__PURE__*/React.createElement(\"div\",{className:\"chat-body\"},/*#__PURE__*/React.createElement(\"div\",{className:\"chat-content\"},chat.textContent))));}):null;return/*#__PURE__*/React.createElement(\"div\",{className:\"content-right\"},/*#__PURE__*/React.createElement(\"div\",{className:\"chat-app-window\"},/*#__PURE__*/React.createElement(\"div\",{className:\"start-chat-area \".concat(activeUser!==null?\"d-none\":\"d-flex\")},/*#__PURE__*/React.createElement(\"span\",{className:\"mb-1 start-chat-icon\"},/*#__PURE__*/React.createElement(MessageSquare,{size:50})),/*#__PURE__*/React.createElement(\"h4\",{className:\"py-50 px-1 sidebar-toggle start-chat-text\",onClick:function onClick(){if(_this2.props.mql.matches===false){_this2.props.mainSidebar(true);}else{return null;}}},\"Start Conversation\")),/*#__PURE__*/React.createElement(\"div\",{className:\"active-chat \".concat(activeUser===null?\"d-none\":\"d-block\")},/*#__PURE__*/React.createElement(\"div\",{className:\"chat_navbar\"},/*#__PURE__*/React.createElement(\"header\",{className:\"chat_header d-flex justify-content-between align-items-center p-1\"},/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex align-items-center\"},/*#__PURE__*/React.createElement(\"div\",{className:\"sidebar-toggle d-block d-lg-none mr-1\",onClick:function onClick(){return _this2.props.mainSidebar(true);}},/*#__PURE__*/React.createElement(Menu,{size:24})),/*#__PURE__*/React.createElement(\"div\",{className:\"avatar user-profile-toggle m-0 m-0 mr-1\",onClick:function onClick(){return _this2.props.handleReceiverSidebar(\"open\");}},/*#__PURE__*/React.createElement(\"img\",{src:activeUser!==null?activeUser.photoURL:\"\",alt:activeUser!==null?activeUser.displayName:\"\",height:\"40\",width:\"40\"}),/*#__PURE__*/React.createElement(\"span\",{className:\"\\n                    \".concat(activeUser!==null&&activeUser.status===\"do not disturb\"?\"avatar-status-busy\":activeUser!==null&&activeUser.status===\"away\"?\"avatar-status-away\":activeUser!==null&&activeUser.status===\"offline\"?\"avatar-status-offline\":\"avatar-status-online\",\"\\n                    \")})),/*#__PURE__*/React.createElement(\"h6\",{className:\"mb-0\"},activeUser!==null?activeUser.displayName:\"\")),/*#__PURE__*/React.createElement(\"span\",{className:\"favorite\",onClick:function onClick(){if(activeChat){_this2.props.togglePinned(activeUser.uid,!activeChat.isPinned);}}},/*#__PURE__*/React.createElement(Star,{size:22,stroke:activeChat&&activeChat.isPinned===true?\"#FF9F43\":\"#626262\"})))),/*#__PURE__*/React.createElement(PerfectScrollbar,{className:\"user-chats\",options:{wheelPropagation:false},ref:function ref(el){_this2.chatArea=el;}},/*#__PURE__*/React.createElement(\"div\",{className:\"chats\"},renderChats)),/*#__PURE__*/React.createElement(\"div\",{className:\"chat-app-form\"},/*#__PURE__*/React.createElement(\"form\",{className:\"chat-app-input d-flex align-items-center\",onSubmit:function onSubmit(e){e.preventDefault();_this2.handleSendMessage(activeUser.uid,false,_this2.state.msg,activeUser);}},/*#__PURE__*/React.createElement(Input,{type:\"text\",className:\"message mr-1 ml-50\",placeholder:\"Type your message\",value:this.state.msg,onChange:function onChange(e){e.preventDefault();_this2.setState({msg:e.target.value});}}),/*#__PURE__*/React.createElement(Button,{color:\"primary\"},/*#__PURE__*/React.createElement(Send,{className:\"d-lg-none\",size:15}),/*#__PURE__*/React.createElement(\"span\",{className:\"d-lg-block d-none\"},\"Send\")))))));}}],[{key:\"getDerivedStateFromProps\",value:function getDerivedStateFromProps(props,state){if(props.activeUser!==state.activeChat||props.activeChat!==state.activeChat){return{activeUser:props.activeUser,activeChat:props.activeChat};}// Return null if the state hasn't changed\nreturn null;}}]);return ChatLog;}(React.Component);var mapStateToProps=function mapStateToProps(state){return{chat:state.chatApp.chats};};export default connect(mapStateToProps,{togglePinned:togglePinned,sendMessage:sendMessage})(ChatLog);","map":null,"metadata":{},"sourceType":"module"}