{"ast":null,"code":"import*as firebase from\"firebase/app\";import{history}from\"../../../history\";// import \"firebase/auth\"\n// import \"firebase/database\"\nimport axios from\"axios\";// import { config } from \"../../../authServices/firebase/firebaseConfig\"\nimport{api_query}from\"../../../api/ApiConstant\";// Init firebase if not already initialized\n// if (!firebase.apps.length) {\n//   firebase.initializeApp(config)\n// }\n// let firebaseAuth = firebase.auth()\n// const initAuth0 = new auth0.WebAuth(configAuth)\n// export const submitLoginWithFireBase = (email, password, remember) => {\n//   return dispatch => {\n//     let userEmail = null,\n//       loggedIn = false\n//     firebaseAuth\n//       .signInWithEmailAndPassword(email, password)\n//       .then(result => {\n//         firebaseAuth.onAuthStateChanged(user => {\n//           result.user.updateProfile({\n//             displayName: \"Admin\"\n//           })\n//           let name = result.user.displayName\n//           if (user) {\n//             userEmail = user.email\n//             loggedIn = true\n//             dispatch({\n//               type: \"LOGIN_WITH_EMAIL\",\n//               payload: {\n//                 email: userEmail,\n//                 name,\n//                 isSignedIn: loggedIn,\n//                 loggedInWith: \"firebase\"\n//               }\n//             })\n//           }\n//           if (user && remember) {\n//             firebase\n//               .auth()\n//               .setPersistence(firebase.auth.Auth.Persistence.SESSION)\n//               .then(() => {\n//                 dispatch({\n//                   type: \"LOGIN_WITH_EMAIL\",\n//                   payload: {\n//                     email: userEmail,\n//                     name,\n//                     isSignedIn: loggedIn,\n//                     remember: true,\n//                     loggedInWith: \"firebase\"\n//                   }\n//                 })\n//               })\n//           }\n//           history.push(\"/\")\n//         })\n//       })\n//       .catch(error => {\n//         console.log(error)\n//       })\n//   }\n// }\n// export const loginWithFB = () => {\n//   return dispatch => {\n//     let provider = new firebase.auth.FacebookAuthProvider()\n//     provider.setCustomParameters({\n//       display: \"popup\"\n//     })\n//     firebaseAuth\n//       .signInWithPopup(provider)\n//       .then(result => {\n//         // This gives you a Facebook Access Token. You can use it to access the Facebook API.\n//         let token = result.credential.accessToken,\n//           // The signed-in user info.\n//           user = result.user.email\n//         dispatch({\n//           type: \"LOGIN_WITH_FB\",\n//           payload: {\n//             user,\n//             token,\n//             loggedInWith: \"firebase\"\n//           }\n//         })\n//         if (user) history.push(\"/\")\n//       })\n//       .catch(error => {\n//         console.log(error)\n//       })\n//   }\n// }\n// export const loginWithTwitter = () => {\n//   return dispatch => {\n//     let provider = new firebase.auth.TwitterAuthProvider()\n//     firebaseAuth\n//       .signInWithPopup(provider)\n//       .then(function(result) {\n//         let token = result.credential.accessToken,\n//           user = result.user.email,\n//           name = result.user.displayName,\n//           photoUrl = result.user.photoURL\n//         dispatch({\n//           type: \"LOGIN_WITH_TWITTER\",\n//           payload: {\n//             user,\n//             name,\n//             photoUrl,\n//             token,\n//             loggedInWith: \"firebase\"\n//           }\n//         })\n//         history.push(\"/\")\n//       })\n//       .catch(function(error) {\n//         console.log(error)\n//       })\n//   }\n// }\n// export const loginWithGoogle = () => {\n//   return dispatch => {\n//     let provider = new firebase.auth.GoogleAuthProvider()\n//     firebaseAuth\n//       .signInWithPopup(provider)\n//       .then(function(result) {\n//         let token = result.credential.accessToken,\n//           user = result.user.email,\n//           name = result.user.displayName,\n//           photoUrl = result.user.photoURL\n//         dispatch({\n//           type: \"LOGIN_WITH_GOOGLE\",\n//           payload: {\n//             email: user,\n//             name: name,\n//             photoUrl,\n//             token,\n//             loggedInWith: \"firebase\"\n//           }\n//         })\n//         history.push(\"/\")\n//       })\n//       .catch(function(error) {\n//         console.log(error)\n//       })\n//   }\n// }\n// export const loginWithGithub = () => {\n//   return dispatch => {\n//     let provider = new firebase.auth.GithubAuthProvider()\n//     firebaseAuth\n//       .signInWithPopup(provider)\n//       .then(function(result) {\n//         let token = result.credential.accessToken,\n//           user = result.user.email,\n//           name = result.additionalUserInfo.username,\n//           photoUrl = result.user.photoURL\n//         dispatch({\n//           type: \"LOGIN_WITH_GITHUB\",\n//           payload: {\n//             user,\n//             name,\n//             photoUrl,\n//             token,\n//             loggedInWith: \"firebase\"\n//           }\n//         })\n//         history.push(\"/\")\n//       })\n//       .catch(function(error) {\n//         console.log(error)\n//       })\n//   }\n// }\n// export const loginWithJWT = user => {\n//   // ngambil dari loginJWT, dia ngirim params semua statenya\n//   return dispatch => {\n//     axios\n//       .post(\"/api/authenticate/login/user\", {\n//         email: user.email,\n//         password: user.password\n//       })\n//       .then(response => {\n//         var loggedInUser\n//         if (response.data) {\n//           loggedInUser = response.data.user\n//           dispatch({\n//             type: \"LOGIN_WITH_JWT\",\n//             payload: { loggedInUser, loggedInWith: \"jwt\" }\n//           })\n//           history.push(\"/\")\n//         }\n//       })\n//       .catch(err => console.log(err))\n//   }\n// }\n// export const logoutWithJWT = () => {\n//   return dispatch => {\n//     dispatch({ type: \"LOGOUT_WITH_JWT\", payload: {} })\n//     history.push(\"/pages/login\")\n//   }\n// }\n// export const logoutWithFirebase = user => {\n//   return dispatch => {\n//     dispatch({ type: \"LOGOUT_WITH_FIREBASE\", payload: {} })\n//     history.push(\"/pages/login\")\n//   }\n// }\nexport var logoutWithCustom=function logoutWithCustom(user){return function(dispatch){dispatch({type:\"LOGOUT_WITH_CUSTOM\",payload:{}});window.localStorage.clear();localStorage.removeItem('account');sessionStorage.clear();// window.localStorage.setItem('account', null)\n// window.location.reload();\n// console.log('mylocal ', localStorage.getItem('account'))\nhistory.push(\"/pages/login\");// window.location.reload();\n};};// export const changeRole = role => {\n//   return dispatch => dispatch({ type: \"CHANGE_ROLE\", userRole: role })\n// }\nexport var loginWithCustom=function loginWithCustom(user){// ngambil dari loginJWT, dia ngirim params semua statenya\nconsole.log('custom log: ',user);return function(dispatch){var sql=\"\\n        select\\n          dmu.id,\\n          dmu.nik,\\n          dmu.name,\\n          convert_from(df_decrypt(password), 'UTF8') as \\\"password\\\" ,\\n          role,\\n          job_level,\\n          departement_id,\\n          active,\\n          dmu.create_by,\\n          dmu.create_date,\\n          dmu.update_by,\\n          dmu.update_date,\\n          dmd.nama_departemen\\n      from df_master_user dmu\\n      left join df_master_departement dmd\\n      on dmd.id = dmu.departement_id\\n      where dmu.nik = '\"+user.nik+\"'\\n    \";// let sql = `\n//   select id,\n//         nik,\n//         name,\n//         convert_from(df_decrypt(password), 'UTF8') as \"password\" ,\n//         role,\n//         job_level,\n//         departement_id,\n//         active,\n//         create_by,\n//         create_date,\n//         update_by,\n//         update_date\n//   from df_master_user dmu\n//   join df_master_departement dmd\n//   on\n//   where nik = '`+user.nik+`'\n// `\n// let sql = `\n// \tselect id, name, email, convert_from(df_decrypt(password), 'UTF8') as \"password\" , role from df_master_user dmu where email = '`+user.email+`'\n// `\naxios.post(api_query,{query:sql}).then(function(response){var loggedInUser;// var _tempUser = response.data.response[0]\nvar _tempUser=response.data.response.rows[0];console.log('response login custom : ',response.data.response.rows[0]);// console.log('response login custom : ', response.data.response[0])\nif(_tempUser!=undefined){if(_tempUser.password==user.password){if(_tempUser.active=='Y'){// loggedInUser = response.data.response[0]\nloggedInUser=response.data.response.rows[0];dispatch({type:\"LOGIN_WITH_CUSTOM\",payload:{id:_tempUser.id,nik:_tempUser.nik,name:_tempUser.name,role:_tempUser.role,job_level:_tempUser.job_level,departement_id:_tempUser.departement_id,nama_departemen:_tempUser.nama_departemen,loggedInWith:\"custom\"}});history.push(\"/home\");window.location.reload(false);}else{history.push(\"/pages/login/?status=user_not_active\");window.location.reload(false);}}else{console.log('Password salah');history.push(\"/pages/login/?status=wrong_password\");window.location.reload(false);// dispatch({\n//   type: \"default\",\n//   payload: {\n//     status: \"Password Salah\",\n//   }\n// })\n}}else{console.log('User tidak ada');history.push(\"/pages/login/?status=user_not_found\");window.location.reload(false);}// if (response.data) {\n//   loggedInUser = response.data.user\n//   dispatch({\n//     type: \"LOGIN_WITH_CUSTOM\",\n//     payload: { loggedInUser, loggedInWith: \"custom\" }\n//   })\n//   history.push(\"/\")\n// }\n}).catch(function(err){return console.log(err);});};};","map":null,"metadata":{},"sourceType":"module"}