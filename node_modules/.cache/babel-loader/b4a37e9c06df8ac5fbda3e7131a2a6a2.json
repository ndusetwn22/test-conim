{"ast":null,"code":"import _regeneratorRuntime from\"/Users/pandusetiawan/Documents/react/df-v1.3 backup build/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/pandusetiawan/Documents/react/df-v1.3 backup build/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _classCallCheck from\"/Users/pandusetiawan/Documents/react/df-v1.3 backup build/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/pandusetiawan/Documents/react/df-v1.3 backup build/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/Users/pandusetiawan/Documents/react/df-v1.3 backup build/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Users/pandusetiawan/Documents/react/df-v1.3 backup build/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React from\"react\";import{api_query}from\"../../../api/ApiConstant\";import{Card,CardBody,CardHeader,CardTitle,Badge,Input,Button,FormGroup,Row,Col,Form,Label,Modal,ModalHeader,ModalBody,ModalFooter,Alert}from\"reactstrap\";import DataTable from\"react-data-table-component\";import{Star,Search,Edit,Trash,ChevronDown,Plus,Check,ChevronLeft,ChevronRight}from\"react-feather\";import axios from'axios';import Toggle from\"react-toggle\";import Select from\"react-select\";import{history}from\"../../../../src/history\";import Spinner from\"../../../components/@vuexy/spinner/Fallback-spinner\";var CustomHeader=function CustomHeader(props){return/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex flex-wrap justify-content-between\"},/*#__PURE__*/React.createElement(\"div\",{className:\"add-new\"},/*#__PURE__*/React.createElement(Button.Ripple,{color:\"none\",className:\"bg-gradient-success\",onClick:function onClick(){return props.buatSS();}},\"Buat SS\")),/*#__PURE__*/React.createElement(\"div\",{className:\"position-relative has-icon-left mb-1\"},/*#__PURE__*/React.createElement(Input,{value:props.value,onChange:function onChange(e){return props.handleFilter(e);}}),/*#__PURE__*/React.createElement(\"div\",{className:\"form-control-position\"},/*#__PURE__*/React.createElement(Search,{size:\"15\"}))));};var TemplateCustomHeader=function TemplateCustomHeader(props){return/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex flex-wrap justify-content-between\"},/*#__PURE__*/React.createElement(\"div\",{className:\"add-new\"},/*#__PURE__*/React.createElement(Button.Ripple,{color:\"none\",className:\"bg-gradient-success\",onClick:function onClick(){return props.tarikData();}},\"Buat SS\")),/*#__PURE__*/React.createElement(\"div\",{className:\"position-relative has-icon-left mb-1\"},/*#__PURE__*/React.createElement(Input,{value:props.value,onChange:function onChange(e){return props.handleFilter(e);}}),/*#__PURE__*/React.createElement(\"div\",{className:\"form-control-position\"},/*#__PURE__*/React.createElement(Search,{size:\"15\"}))));};var ActionsComponent=function ActionsComponent(props){return/*#__PURE__*/React.createElement(\"div\",{className:\"data-list-action\"},/*#__PURE__*/React.createElement(Button.Ripple,{className:\"mr-1 bg-gradient-success\",color:\"none\",size:\"sm\",onClick:function onClick(){// console.log('props : ', props);\nreturn props.isView(props.row,props.row.id,props.row.cff_id);}},\"View\"));};var SendComponent=function SendComponent(props){return/*#__PURE__*/React.createElement(\"div\",{className:\"data-list-action\"},/*#__PURE__*/React.createElement(Button.Ripple,{className:\"mr-1 bg-gradient-success\",color:\"none\",size:\"sm\",onClick:function onClick(){console.log('props : ',props);console.log('digimon : ',props.row.name);return props.isVisible(props.row.name,props.row.img);}},\" Send\"));};var EditsComponent=function EditsComponent(props){return/*#__PURE__*/React.createElement(\"div\",{className:\"data-list-action\"},/*#__PURE__*/React.createElement(Button.Ripple,{className:\"mr-1 bg-gradient-warning\",color:\"none\",size:\"sm\",onClick:function onClick(){// console.log('props : ', props);\n// console.log('digimon : ', props.row.name);\nreturn props.isVisible(props.row.name,props.row.img);}},\" Edit\"));};var OpSsTable=/*#__PURE__*/function(_React$Component){_inherits(OpSsTable,_React$Component);var _super=_createSuper(OpSsTable);function OpSsTable(){var _this;_classCallCheck(this,OpSsTable);for(var _len=arguments.length,args=new Array(_len),_key=0;_key<_len;_key++){args[_key]=arguments[_key];}_this=_super.call.apply(_super,[this].concat(args));_this.state={modalApproval:false,dataApproval:[],columnsApproval:[{name:\"Nama\",selector:\"nama\",sortable:true,minWidth:\"200px\",cell:function cell(row){return/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex flex-xl-row flex-column align-items-xl-center align-items-start py-xl-0 py-1\"},/*#__PURE__*/React.createElement(\"div\",{className:\"user-info text-truncate ml-xl-50 ml-0\"},/*#__PURE__*/React.createElement(\"span\",{title:row.name,className:\"d-block text-bold-500 text-truncate mb-0\"},row.name)));}},{name:\"Status\",selector:\"approval_rejected_status\",sortable:true,minWidth:\"200px\",cell:function cell(row){return/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex flex-xl-row flex-column align-items-xl-center align-items-start py-xl-0 py-1\"},/*#__PURE__*/React.createElement(\"div\",{className:\"user-info text-truncate ml-xl-50 ml-0\"},/*#__PURE__*/React.createElement(\"span\",{title:row.approval_rejected_status,className:\"d-block text-bold-500 text-truncate mb-0\"},row.approval_rejected_status)));}},{name:\"Tanggal\",selector:\"approve_date\",sortable:true,minWidth:\"200px\",cell:function cell(row){return/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex flex-xl-row flex-column align-items-xl-center align-items-start py-xl-0 py-1\"},/*#__PURE__*/React.createElement(\"div\",{className:\"user-info text-truncate ml-xl-50 ml-0\"},/*#__PURE__*/React.createElement(\"span\",{title:row.approve_date,className:\"d-block text-bold-500 text-truncate mb-0\"},row.approve_date)));}}],modalVisible:false,modalImage:'',modalDigimonName:'',myProfile:null,isLoading:false,columns:[{name:\"Tema\",selector:\"tema\",sortable:true,minWidth:\"200px\",cell:function cell(row){return/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex flex-xl-row flex-column align-items-xl-center align-items-start py-xl-0 py-1\"},/*#__PURE__*/React.createElement(\"div\",{className:\"user-info text-truncate ml-xl-50 ml-0\"},/*#__PURE__*/React.createElement(\"span\",{title:row.tema_singkat,className:\"d-block text-bold-500 text-truncate mb-0\"},row.tema_singkat)));}},{name:\"Tanggal dibuat\",selector:\"tgl\",sortable:true,minWidth:\"200px\",cell:function cell(row){return/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex flex-xl-row flex-column align-items-xl-center align-items-start py-xl-0 py-1\"},/*#__PURE__*/React.createElement(\"div\",{className:\"user-info text-truncate ml-xl-50 ml-0\"},/*#__PURE__*/React.createElement(\"span\",{title:row.tgl,className:\"d-block text-bold-500 text-truncate mb-0\"},row.tgl)));}},{name:\"Status\",selector:\"status_deskripsi\",sortable:true,minWidth:\"200px\",cell:function cell(row){return/*#__PURE__*/React.createElement(\"div\",{className:\"d-flex flex-xl-row flex-column align-items-xl-center align-items-start py-xl-0 py-1\"},/*#__PURE__*/React.createElement(\"div\",{className:\"user-info text-truncate ml-xl-50 ml-0\"},/*#__PURE__*/React.createElement(\"a\",{onClick:function onClick(){return _this.viewApproval(row);}},/*#__PURE__*/React.createElement(\"span\",{title:row.status_deskripsi,className:\"d-block text-bold-500 text-truncate mb-0\"},row.status_deskripsi))));}},{name:\"Actions\",sortable:true,cell:function cell(row){return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(ActionsComponent,{row:row// getData={this.state.data}\n,isView:_this.viewSS// isVisible= {this.toggleModalDigimon}\n}));}}],data:[],filteredData:[],value:\"\"};_this.componentDidMount=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_this.setState({isLoading:true});_context.next=3;return _this.isLogin('op_df');case 3:_context.next=5;return _this.tarikDataTable();case 5:_this.setState({isLoading:false});// await this.tarikData();\n// await this.tarikDataPostgre();\n// console.log('state data:', typeof(this.state.data))\n// console.log('local', JSON.parse(localStorage.getItem('account')).role)\ncase 6:case\"end\":return _context.stop();}}},_callee);}));_this.toggleModalApproval=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(id){var sql,result;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.next=2;return _this.setState(function(prevState){return{isLoading:true// modalApproval: !prevState.modalApproval\n};});case 2:sql=\"\\n        select dsha.ss_id, dsha.approved_rejected_by_id, dmu.\\\"name\\\", dsha.approval_rejected_status, dsha.create_date, COALESCE(to_char(dsha.create_date , 'DD Mon YYYY HH24:MI:SS'), '') AS approve_date from df_ss_history_approval dsha \\n        join df_master_user dmu\\n        on dsha.approved_rejected_by_id = dmu.id \\n        where dsha.ss_id = \"+id+\"\\n        order by dsha.id asc\\n    \";_context3.next=5;return axios.post(api_query,{query:sql}).then(/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(result){var res;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:res=result.data.response.rows;console.log('result : ',result);if(!(res.length=='')){_context2.next=6;break;}return _context2.abrupt(\"return\",[]);case 6:_context2.next=8;return _this.setState({dataApproval:res});case 8:case\"end\":return _context2.stop();}}},_callee2);}));return function(_x2){return _ref3.apply(this,arguments);};}()).catch(function(err){console.log('error : ',err);return[];});case 5:result=_context3.sent;_context3.next=8;return _this.setState(function(prevState){return{isLoading:true,modalApproval:!prevState.modalApproval};});case 8:_context3.next=10;return _this.setState({isLoading:false});case 10:case\"end\":return _context3.stop();}}},_callee3);}));return function(_x){return _ref2.apply(this,arguments);};}();_this.toggleModalFixApproval=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(){return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_this.setState(function(prevState){return{modalApproval:!prevState.modalApproval,dataApproval:[]};});case 1:case\"end\":return _context4.stop();}}},_callee4);}));_this.isLogin=/*#__PURE__*/function(){var _ref5=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(role){var myProfile;return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:if(localStorage.getItem('account')==undefined||localStorage.getItem('account')==null){history.push(\"/pages/login\");}else if(JSON.parse(localStorage.getItem('account')).role!==role){history.push(\"/pages/login\");}else{myProfile=JSON.parse(localStorage.getItem('account'));console.log('myProfile',myProfile);_this.setState({myProfile:myProfile});}case 1:case\"end\":return _context5.stop();}}},_callee5);}));return function(_x3){return _ref5.apply(this,arguments);};}();_this.toggleModalDigimon=/*#__PURE__*/function(){var _ref6=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee6(name,img){return _regeneratorRuntime.wrap(function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:console.log('LAUNCH TOGGLE DIGIMON');if(!(name==undefined)){_context6.next=6;break;}_context6.next=4;return _this.setState({modalVisible:false,modalImage:null,modalNameDigimon:''});case 4:_context6.next=8;break;case 6:_context6.next=8;return _this.setState({modalVisible:!_this.state.modalVisible,modalImage:img,modalDigimonName:name});case 8:case\"end\":return _context6.stop();}}},_callee6);}));return function(_x4,_x5){return _ref6.apply(this,arguments);};}();_this.viewSS=/*#__PURE__*/function(){var _ref7=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee7(data,id,cff_id){return _regeneratorRuntime.wrap(function _callee7$(_context7){while(1){switch(_context7.prev=_context7.next){case 0:console.log('view SS : ',id);console.log('data row : ',data);_this.props.changeViewPage('edit',data,id);case 3:case\"end\":return _context7.stop();}}},_callee7);}));return function(_x6,_x7,_x8){return _ref7.apply(this,arguments);};}();_this.viewApproval=/*#__PURE__*/function(){var _ref8=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee8(data){return _regeneratorRuntime.wrap(function _callee8$(_context8){while(1){switch(_context8.prev=_context8.next){case 0:console.log('viewApproval : ',data);console.log('viewApproval : ',data.ds_id);_context8.next=4;return _this.toggleModalApproval(data.ds_id);case 4:case\"end\":return _context8.stop();}}},_callee8);}));return function(_x9){return _ref8.apply(this,arguments);};}();_this.buatSS=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee9(){return _regeneratorRuntime.wrap(function _callee9$(_context9){while(1){switch(_context9.prev=_context9.next){case 0:console.log('BUATSS SS');_context9.next=3;return _this.props.changeViewPage('add');case 3:case\"end\":return _context9.stop();}}},_callee9);}));_this.tarikData=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee10(){var result;return _regeneratorRuntime.wrap(function _callee10$(_context10){while(1){switch(_context10.prev=_context10.next){case 0:_context10.next=2;return axios.get('https://digimon-api.vercel.app/api/digimon').then(function(result){// console.log('result digimon : ', result)\nvar res=result.data;console.log('result : ',result);if(res.length==''){return[];}// console.log('result : ', (result.data))\nreturn res;}).catch(function(err){return[];});case 2:result=_context10.sent;_context10.next=5;return _this.setState({data:result});case 5:case\"end\":return _context10.stop();}}},_callee10);}));_this.tarikDataPostgre=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee11(){var sql,result;return _regeneratorRuntime.wrap(function _callee11$(_context11){while(1){switch(_context11.prev=_context11.next){case 0:// console.log('tarik data')\n// let sql = `\n//     select * from employees_new limit 10000;\n// `\nconsole.log('test query');sql=\"\\n      select * from df_master_user\\n      \";_context11.next=4;return axios.post(api_query,{query:sql}).then(function(result){var res=result.data.response;// console.log('result : ', result)\nconsole.log('result postgres : ',result);console.log('postgres : ',res);if(res.length==''){return[];}}).catch(function(err){console.log('error : ',err);return[];});case 4:result=_context11.sent;_context11.next=7;return _this.setState({position:result});case 7:case\"end\":return _context11.stop();}}},_callee11);}));_this.tarikDataTable=/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee13(){var sql,result;return _regeneratorRuntime.wrap(function _callee13$(_context13){while(1){switch(_context13.prev=_context13.next){case 0:// let sql = `\n// select *, to_char(ds.tanggal_dibuat, 'dd Mon yyyy') as tgl, dss.status_deskripsi\n//         from df_ss ds\n//         join df_ss_status dss\n//         on ds.ss_status_id = dss.id\n//   where\n//     pengusul_id = `+this.state.myProfile.id+` and\n//     ss_status_id != `+9+`\n// `\n// order by tgl DESC\nsql=\"\\n    select *, to_char(ds.tanggal_dibuat, 'dd Mon yyyy') as tgl, dss.status_deskripsi, ds.id as ds_id\\n    from df_suggestion_system ds\\n        join df_ss_status dss\\n        on ds.ss_status_id = dss.id\\n    where\\n        ds.pengusul_id = \"+_this.state.myProfile.id+\" and\\n        ds.ss_status_id != 9\\n        order by ds.id DESC\\n    \";_context13.next=3;return axios.post(api_query,{query:sql}).then(/*#__PURE__*/function(){var _ref13=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee12(result){var res,_temp,index,element,temaSingkat,tema;return _regeneratorRuntime.wrap(function _callee12$(_context12){while(1){switch(_context12.prev=_context12.next){case 0:// let res = result.data.response\nres=result.data.response.rows;// console.log('result : ', result)\n// console.log('result postgres : ', result)\nconsole.log('result query : ',res);console.log('query leng :',res.length);if(!(res.length=='')){_context12.next=7;break;}return _context12.abrupt(\"return\",[]);case 7:_temp=[];for(index=0;index<res.length;index++){element=res[index].tema;temaSingkat=element.split(' ').slice(0,2).join(' ');temaSingkat=temaSingkat+' ... ';tema=res[index];tema.tema_singkat=temaSingkat;// console.log('dummy : ', dummy)\n// // const elementTgl = res[index].tanggal_dibuat;\n// // var tgl = elementTgl.split('T')\n// console.log('tgl query : ', res[index].tgl)\n// console.log('tema singkat : ', temaSingkat)\n// // console.log('tanggal : ', tgl[0])\n// console.log('element:', element)\n_temp.push(tema);}if(!(_temp.length=='')){_context12.next=14;break;}_context12.next=12;return _this.setState({data:[]});case 12:_context12.next=16;break;case 14:_context12.next=16;return _this.setState({data:_temp});case 16:case\"end\":return _context12.stop();}}},_callee12);}));return function(_x10){return _ref13.apply(this,arguments);};}()).catch(function(err){console.log('error : ',err);return[];});case 3:result=_context13.sent;case 4:case\"end\":return _context13.stop();}}},_callee13);}));_this.handleFilter=function(e){var value=e.target.value;var data=_this.state.data;var filteredData=_this.state.filteredData;_this.setState({value:value});if(value.length){filteredData=data.filter(function(item){// console.log('ITEM : ', item)\nvar startsWithCondition=item.tema.toLowerCase().startsWith(value.toLowerCase())||item.tgl.toLowerCase().startsWith(value.toLowerCase())||item.status_deskripsi.toLowerCase().startsWith(value.toLowerCase());// item.name.toLowerCase().startsWith(value.toLowerCase())\n// item.date.toLowerCase().startsWith(value.toLowerCase()) ||\n// item.email.toLowerCase().startsWith(value.toLowerCase()) ||\n// item.revenue.toLowerCase().startsWith(value.toLowerCase()) ||\n// item.status.toLowerCase().startsWith(value.toLowerCase())\nvar includesCondition=item.tema.toLowerCase().includes(value.toLowerCase())||item.tgl.toLowerCase().includes(value.toLowerCase())||item.status_deskripsi.toLowerCase().includes(value.toLowerCase());// item.name.toLowerCase().includes(value.toLowerCase())\n// item.date.toLowerCase().includes(value.toLowerCase()) ||\n// item.email.toLowerCase().includes(value.toLowerCase()) ||\n// item.revenue.toLowerCase().includes(value.toLowerCase()) ||\n// item.status.toLowerCase().includes(value.toLowerCase())\nif(startsWithCondition){return startsWithCondition;}else if(!startsWithCondition&&includesCondition){return includesCondition;}else return null;});_this.setState({filteredData:filteredData});}};return _this;}_createClass(OpSsTable,[{key:\"render\",value:function render(){var _this$state=this.state,data=_this$state.data,columns=_this$state.columns,value=_this$state.value,filteredData=_this$state.filteredData;return/*#__PURE__*/React.createElement(React.Fragment,null,!this.state.isLoading?/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(Card,null,/*#__PURE__*/React.createElement(CardHeader,null,/*#__PURE__*/React.createElement(CardTitle,null,\"Suggestion System Table\")),/*#__PURE__*/React.createElement(CardBody,{className:\"rdt_Wrapper\"},/*#__PURE__*/React.createElement(DataTable,{className:\"dataTable-custom\",data:value.length?filteredData:data,columns:columns,noHeader:true,pagination:true,subHeader:true,subHeaderComponent:/*#__PURE__*/React.createElement(CustomHeader,{value:value,handleFilter:this.handleFilter,buatSS:this.buatSS})// <CustomHeader value={value} handleFilter={this.handleFilter} tarikData={this.tarikDataTable}/>\n}))),/*#__PURE__*/React.createElement(Modal,{isOpen:this.state.modalApproval,toggle:this.toggleModalApproval,className:\"modal-dialog-centered\",backdrop:\"static\"},/*#__PURE__*/React.createElement(ModalHeader,{toggle:this.toggleModalFixApproval,className:\"bg-success\"},\"List approval\"),/*#__PURE__*/React.createElement(ModalBody,{className:\"modal-dialog-centered\"},/*#__PURE__*/React.createElement(DataTable,{className:\"dataTable-custom\",data:this.state.dataApproval,columns:this.state.columnsApproval,noHeader:true})),/*#__PURE__*/React.createElement(ModalFooter,null,/*#__PURE__*/React.createElement(Button,{color:\"danger\",onClick:this.toggleModalFixApproval},\"close\"),\" \"))):/*#__PURE__*/React.createElement(Spinner,null));}}]);return OpSsTable;}(React.Component);export default OpSsTable;","map":null,"metadata":{},"sourceType":"module"}