{"ast":null,"code":"var _jsxFileName = \"E:\\\\react\\\\belajar-react\\\\src\\\\extensions\\\\import-export\\\\Export.js\";\nimport React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport ExtensionsHeader from \"../extensionsHeader\";\nimport { Row, Col, Card, CardBody, Button, Table, Modal, ModalHeader, ModalBody, ModalFooter, Input, FormGroup, CustomInput } from \"reactstrap\";\nimport { Search } from \"react-feather\";\nimport XLSX from \"xlsx\";\nimport * as FileSaver from \"file-saver\";\n\nclass Export extends React.Component {\n  constructor(...args) {\n    super(...args);\n    this.state = {\n      data: [{\n        id: 1,\n        name: \"Leanne Graham\",\n        username: \"Bret\",\n        email: \"Sincere@april.biz\",\n        website: \"hildegard.org\"\n      }, {\n        id: 2,\n        name: \"Ervin Howell\",\n        username: \"Antonette\",\n        email: \"Shanna@melissa.tv\",\n        website: \"anastasia.net\"\n      }, {\n        id: 3,\n        name: \"Clementine Bauch\",\n        username: \"Samantha\",\n        email: \"Nathan@yesenia.net\",\n        website: \"ramiro.info\"\n      }, {\n        id: 4,\n        name: \"Patricia Lebsack\",\n        username: \"Karianne\",\n        email: \"Julianne.OConner@kory.org\",\n        website: \"kale.biz\"\n      }, {\n        id: 5,\n        name: \"Chelsey Dietrich\",\n        username: \"Kamren\",\n        email: \"Lucio_Hettinger@annie.ca\",\n        website: \"demarco.info\"\n      }, {\n        id: 6,\n        name: \"Mrs. Dennis Schulist\",\n        username: \"Leopoldo_Corkery\",\n        email: \"Karley_Dach@jasper.info\",\n        website: \"ola.org\"\n      }, {\n        id: 7,\n        name: \"Kurtis Weissnat\",\n        username: \"Elwyn.Skiles\",\n        email: \"Telly.Hoeger@billy.biz\",\n        website: \"elvis.io\"\n      }, {\n        id: 8,\n        name: \"Nicholas Runolfsdottir V\",\n        username: \"Maxime_Nienow\",\n        email: \"Sherwood@rosamond.me\",\n        website: \"jacynthe.com\"\n      }, {\n        id: 9,\n        name: \"Glenna Reichert\",\n        username: \"Delphine\",\n        email: \"Chaim_McDermott@dana.io\",\n        website: \"conrad.com\"\n      }, {\n        id: 10,\n        name: \"Clementina DuBuque\",\n        username: \"Moriah.Stanton\",\n        email: \"Rey.Padberg@karina.biz\",\n        website: \"ambrose.net\"\n      }],\n      filteredData: [],\n      value: \"\",\n      modal: false,\n      fileName: \"\",\n      fileFormat: \"xlsx\"\n    };\n\n    this.toggleModal = () => {\n      this.setState({\n        modal: !this.state.modal\n      });\n    };\n\n    this.handleFilter = e => {\n      let data = this.state.data;\n      let filteredData = [];\n      let value = e.target.value;\n      this.setState({\n        value\n      });\n\n      if (value.length) {\n        filteredData = data.filter(col => {\n          let startsWithCondition = col.name.toLowerCase().startsWith(value.toLowerCase()) || col.email.toLowerCase().startsWith(value.toLowerCase()) || col.website.toLowerCase().startsWith(value.toLowerCase()) || col.id.toString().toLowerCase().startsWith(value.toLowerCase());\n          let includesCondition = col.name.toLowerCase().includes(value.toLowerCase()) || col.email.toLowerCase().includes(value.toLowerCase()) || col.website.toLowerCase().includes(value.toLowerCase()) || col.id.toString().toLowerCase().includes(value.toLowerCase());\n          if (startsWithCondition) return startsWithCondition;else if (!startsWithCondition && includesCondition) return includesCondition;else return null;\n        });\n        this.setState({\n          value,\n          filteredData\n        });\n      }\n    };\n\n    this.handleExport = () => {\n      this.toggleModal();\n      let table = ReactDOM.findDOMNode(this.tableRef);\n      let bookType = this.state.fileFormat.length ? this.state.fileFormat : \"xlsx\";\n      let wb = XLSX.utils.table_to_book(table, {\n        sheet: \"Sheet JS\"\n      });\n      let wbout = XLSX.write(wb, {\n        bookType,\n        bookSST: true,\n        type: \"binary\"\n      });\n\n      const s2ab = s => {\n        var buf = new ArrayBuffer(s.length);\n        var view = new Uint8Array(buf);\n\n        for (var i = 0; i < s.length; i++) view[i] = s.charCodeAt(i) & 0xff;\n\n        return buf;\n      };\n\n      let file = this.state.fileFormat.length && this.state.fileFormat.length ? `${this.state.fileName}.${this.state.fileFormat}` : this.state.fileName.length ? `${this.state.fileName}.xlsx` : this.state.fileFormat.length ? `excel-sheet.${this.state.fileFormat}` : \"excel-sheet.xlsx\";\n      return FileSaver.saveAs(new Blob([s2ab(wbout)], {\n        type: \"application/octet-stream\"\n      }), file);\n    };\n  }\n\n  render() {\n    let array = this.state.value ? this.state.filteredData : this.state.data;\n    let renderTableData = array.map(col => {\n      return /*#__PURE__*/React.createElement(\"tr\", {\n        key: col.id,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 174,\n          columnNumber: 9\n        }\n      }, /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 175,\n          columnNumber: 11\n        }\n      }, col.email), /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 176,\n          columnNumber: 11\n        }\n      }, col.name), /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 177,\n          columnNumber: 11\n        }\n      }, col.website), /*#__PURE__*/React.createElement(\"td\", {\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 178,\n          columnNumber: 11\n        }\n      }, col.id));\n    });\n    return /*#__PURE__*/React.createElement(React.Fragment, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 183,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(ExtensionsHeader, {\n      title: \"XLSX\",\n      subTitle: \"Xlsx is a parser and writer for various spreadsheet formats\",\n      link: \"https://github.com/AdeleD/react-paginate\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 184,\n        columnNumber: 9\n      }\n    }), /*#__PURE__*/React.createElement(Row, {\n      className: \"export-component\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 189,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(Col, {\n      sm: \"12\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 190,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(Card, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 191,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(CardBody, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 192,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(Row, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 193,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(Col, {\n      sm: \"12\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 194,\n        columnNumber: 19\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"d-flex justify-content-between flex-wrap\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 195,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(Button.Ripple, {\n      color: \"primary\",\n      onClick: this.toggleModal,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 196,\n        columnNumber: 23\n      }\n    }, \"Export\"), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"filter position-relative has-icon-left\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 199,\n        columnNumber: 23\n      }\n    }, /*#__PURE__*/React.createElement(Input, {\n      type: \"text\",\n      value: this.state.value,\n      onChange: e => this.handleFilter(e),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 200,\n        columnNumber: 25\n      }\n    }), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"form-control-position\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 205,\n        columnNumber: 25\n      }\n    }, /*#__PURE__*/React.createElement(Search, {\n      size: 15,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 206,\n        columnNumber: 27\n      }\n    }))))), /*#__PURE__*/React.createElement(Col, {\n      sm: \"12\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 211,\n        columnNumber: 19\n      }\n    }, /*#__PURE__*/React.createElement(Table, {\n      innerRef: el => this.tableRef = el,\n      className: \"table-hover-animation mt-2\",\n      responsive: true,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 212,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"thead\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 216,\n        columnNumber: 23\n      }\n    }, /*#__PURE__*/React.createElement(\"tr\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 217,\n        columnNumber: 25\n      }\n    }, /*#__PURE__*/React.createElement(\"th\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 218,\n        columnNumber: 27\n      }\n    }, \"Email\"), /*#__PURE__*/React.createElement(\"th\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 219,\n        columnNumber: 27\n      }\n    }, \"Name\"), /*#__PURE__*/React.createElement(\"th\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 220,\n        columnNumber: 27\n      }\n    }, \"Website\"), /*#__PURE__*/React.createElement(\"th\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 221,\n        columnNumber: 27\n      }\n    }, \"Rank\"))), /*#__PURE__*/React.createElement(\"tbody\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 224,\n        columnNumber: 23\n      }\n    }, renderTableData)))))))), /*#__PURE__*/React.createElement(Modal, {\n      isOpen: this.state.modal,\n      toggle: this.toggleModal,\n      className: \"modal-dialog-centered\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 232,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(ModalHeader, {\n      toggle: this.toggleModal,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 236,\n        columnNumber: 11\n      }\n    }, \"Export To Excel\"), /*#__PURE__*/React.createElement(ModalBody, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 237,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(FormGroup, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 238,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(Input, {\n      type: \"text\",\n      value: this.state.fileName,\n      onChange: e => this.setState({\n        fileName: e.target.value\n      }),\n      placeholder: \"Enter File Name\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 239,\n        columnNumber: 15\n      }\n    })), /*#__PURE__*/React.createElement(FormGroup, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 246,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(CustomInput, {\n      type: \"select\",\n      id: \"selectFileFormat\",\n      name: \"customSelect\",\n      value: this.state.fileFormat,\n      onChange: e => this.setState({\n        fileFormat: e.target.value\n      }),\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 247,\n        columnNumber: 15\n      }\n    }, /*#__PURE__*/React.createElement(\"option\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 253,\n        columnNumber: 17\n      }\n    }, \"xlsx\"), /*#__PURE__*/React.createElement(\"option\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 254,\n        columnNumber: 17\n      }\n    }, \"csv\"), /*#__PURE__*/React.createElement(\"option\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 255,\n        columnNumber: 17\n      }\n    }, \"txt\")))), /*#__PURE__*/React.createElement(ModalFooter, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 259,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(Button, {\n      color: \"primary\",\n      onClick: this.handleExport,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 260,\n        columnNumber: 13\n      }\n    }, \"Export\"), /*#__PURE__*/React.createElement(Button, {\n      color: \"flat-danger\",\n      onClick: this.toggleModal,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 263,\n        columnNumber: 13\n      }\n    }, \"Cancel\"))));\n  }\n\n}\n\nexport default Export;","map":{"version":3,"sources":["E:/react/belajar-react/src/extensions/import-export/Export.js"],"names":["React","ReactDOM","ExtensionsHeader","Row","Col","Card","CardBody","Button","Table","Modal","ModalHeader","ModalBody","ModalFooter","Input","FormGroup","CustomInput","Search","XLSX","FileSaver","Export","Component","state","data","id","name","username","email","website","filteredData","value","modal","fileName","fileFormat","toggleModal","setState","handleFilter","e","target","length","filter","col","startsWithCondition","toLowerCase","startsWith","toString","includesCondition","includes","handleExport","table","findDOMNode","tableRef","bookType","wb","utils","table_to_book","sheet","wbout","write","bookSST","type","s2ab","s","buf","ArrayBuffer","view","Uint8Array","i","charCodeAt","file","saveAs","Blob","render","array","renderTableData","map","el"],"mappings":"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","sourcesContent":["import React from \"react\"\nimport ReactDOM from \"react-dom\"\nimport ExtensionsHeader from \"../extensionsHeader\"\nimport {\n  Row,\n  Col,\n  Card,\n  CardBody,\n  Button,\n  Table,\n  Modal,\n  ModalHeader,\n  ModalBody,\n  ModalFooter,\n  Input,\n  FormGroup,\n  CustomInput\n} from \"reactstrap\"\nimport { Search } from \"react-feather\"\nimport XLSX from \"xlsx\"\nimport * as FileSaver from \"file-saver\"\n\nclass Export extends React.Component {\n  state = {\n    data: [\n      {\n        id: 1,\n        name: \"Leanne Graham\",\n        username: \"Bret\",\n        email: \"Sincere@april.biz\",\n        website: \"hildegard.org\"\n      },\n      {\n        id: 2,\n        name: \"Ervin Howell\",\n        username: \"Antonette\",\n        email: \"Shanna@melissa.tv\",\n        website: \"anastasia.net\"\n      },\n      {\n        id: 3,\n        name: \"Clementine Bauch\",\n        username: \"Samantha\",\n        email: \"Nathan@yesenia.net\",\n        website: \"ramiro.info\"\n      },\n      {\n        id: 4,\n        name: \"Patricia Lebsack\",\n        username: \"Karianne\",\n        email: \"Julianne.OConner@kory.org\",\n        website: \"kale.biz\"\n      },\n      {\n        id: 5,\n        name: \"Chelsey Dietrich\",\n        username: \"Kamren\",\n        email: \"Lucio_Hettinger@annie.ca\",\n        website: \"demarco.info\"\n      },\n      {\n        id: 6,\n        name: \"Mrs. Dennis Schulist\",\n        username: \"Leopoldo_Corkery\",\n        email: \"Karley_Dach@jasper.info\",\n        website: \"ola.org\"\n      },\n      {\n        id: 7,\n        name: \"Kurtis Weissnat\",\n        username: \"Elwyn.Skiles\",\n        email: \"Telly.Hoeger@billy.biz\",\n        website: \"elvis.io\"\n      },\n      {\n        id: 8,\n        name: \"Nicholas Runolfsdottir V\",\n        username: \"Maxime_Nienow\",\n        email: \"Sherwood@rosamond.me\",\n        website: \"jacynthe.com\"\n      },\n      {\n        id: 9,\n        name: \"Glenna Reichert\",\n        username: \"Delphine\",\n        email: \"Chaim_McDermott@dana.io\",\n        website: \"conrad.com\"\n      },\n      {\n        id: 10,\n        name: \"Clementina DuBuque\",\n        username: \"Moriah.Stanton\",\n        email: \"Rey.Padberg@karina.biz\",\n        website: \"ambrose.net\"\n      }\n    ],\n    filteredData: [],\n    value: \"\",\n    modal: false,\n    fileName: \"\",\n    fileFormat: \"xlsx\"\n  }\n\n  toggleModal = () => {\n    this.setState({ modal: !this.state.modal })\n  }\n\n  handleFilter = e => {\n    let data = this.state.data\n    let filteredData = []\n    let value = e.target.value\n    this.setState({ value })\n    if (value.length) {\n      filteredData = data.filter(col => {\n        let startsWithCondition =\n          col.name.toLowerCase().startsWith(value.toLowerCase()) ||\n          col.email.toLowerCase().startsWith(value.toLowerCase()) ||\n          col.website.toLowerCase().startsWith(value.toLowerCase()) ||\n          col.id\n            .toString()\n            .toLowerCase()\n            .startsWith(value.toLowerCase())\n\n        let includesCondition =\n          col.name.toLowerCase().includes(value.toLowerCase()) ||\n          col.email.toLowerCase().includes(value.toLowerCase()) ||\n          col.website.toLowerCase().includes(value.toLowerCase()) ||\n          col.id\n            .toString()\n            .toLowerCase()\n            .includes(value.toLowerCase())\n\n        if (startsWithCondition) return startsWithCondition\n        else if (!startsWithCondition && includesCondition)\n          return includesCondition\n        else return null\n      })\n      this.setState({ value, filteredData })\n    }\n  }\n\n  handleExport = () => {\n    this.toggleModal()\n    let table = ReactDOM.findDOMNode(this.tableRef)\n    let bookType = this.state.fileFormat.length ? this.state.fileFormat : \"xlsx\"\n    let wb = XLSX.utils.table_to_book(table, { sheet: \"Sheet JS\" })\n    let wbout = XLSX.write(wb, { bookType, bookSST: true, type: \"binary\" })\n\n    const s2ab = s => {\n      var buf = new ArrayBuffer(s.length)\n      var view = new Uint8Array(buf)\n      for (var i = 0; i < s.length; i++) view[i] = s.charCodeAt(i) & 0xff\n      return buf\n    }\n    let file =\n      this.state.fileFormat.length && this.state.fileFormat.length\n        ? `${this.state.fileName}.${this.state.fileFormat}`\n        : this.state.fileName.length\n        ? `${this.state.fileName}.xlsx`\n        : this.state.fileFormat.length\n        ? `excel-sheet.${this.state.fileFormat}`\n        : \"excel-sheet.xlsx\"\n\n    return FileSaver.saveAs(\n      new Blob([s2ab(wbout)], { type: \"application/octet-stream\" }),\n      file\n    )\n  }\n\n  render() {\n    let array = this.state.value ? this.state.filteredData : this.state.data\n    let renderTableData = array.map(col => {\n      return (\n        <tr key={col.id}>\n          <td>{col.email}</td>\n          <td>{col.name}</td>\n          <td>{col.website}</td>\n          <td>{col.id}</td>\n        </tr>\n      )\n    })\n    return (\n      <React.Fragment>\n        <ExtensionsHeader\n          title=\"XLSX\"\n          subTitle=\"Xlsx is a parser and writer for various spreadsheet formats\"\n          link=\"https://github.com/AdeleD/react-paginate\"\n        />\n        <Row className=\"export-component\">\n          <Col sm=\"12\">\n            <Card>\n              <CardBody>\n                <Row>\n                  <Col sm=\"12\">\n                    <div className=\"d-flex justify-content-between flex-wrap\">\n                      <Button.Ripple color=\"primary\" onClick={this.toggleModal}>\n                        Export\n                      </Button.Ripple>\n                      <div className=\"filter position-relative has-icon-left\">\n                        <Input\n                          type=\"text\"\n                          value={this.state.value}\n                          onChange={e => this.handleFilter(e)}\n                        />\n                        <div className=\"form-control-position\">\n                          <Search size={15} />\n                        </div>\n                      </div>\n                    </div>\n                  </Col>\n                  <Col sm=\"12\">\n                    <Table\n                      innerRef={el => (this.tableRef = el)}\n                      className=\"table-hover-animation mt-2\"\n                      responsive>\n                      <thead>\n                        <tr>\n                          <th>Email</th>\n                          <th>Name</th>\n                          <th>Website</th>\n                          <th>Rank</th>\n                        </tr>\n                      </thead>\n                      <tbody>{renderTableData}</tbody>\n                    </Table>\n                  </Col>\n                </Row>\n              </CardBody>\n            </Card>\n          </Col>\n        </Row>\n        <Modal\n          isOpen={this.state.modal}\n          toggle={this.toggleModal}\n          className=\"modal-dialog-centered\">\n          <ModalHeader toggle={this.toggleModal}>Export To Excel</ModalHeader>\n          <ModalBody>\n            <FormGroup>\n              <Input\n                type=\"text\"\n                value={this.state.fileName}\n                onChange={e => this.setState({ fileName: e.target.value })}\n                placeholder=\"Enter File Name\"\n              />\n            </FormGroup>\n            <FormGroup>\n              <CustomInput\n                type=\"select\"\n                id=\"selectFileFormat\"\n                name=\"customSelect\"\n                value={this.state.fileFormat}\n                onChange={e => this.setState({ fileFormat: e.target.value })}>\n                <option>xlsx</option>\n                <option>csv</option>\n                <option>txt</option>\n              </CustomInput>\n            </FormGroup>\n          </ModalBody>\n          <ModalFooter>\n            <Button color=\"primary\" onClick={this.handleExport}>\n              Export\n            </Button>\n            <Button color=\"flat-danger\" onClick={this.toggleModal}>\n              Cancel\n            </Button>\n          </ModalFooter>\n        </Modal>\n      </React.Fragment>\n    )\n  }\n}\n\nexport default Export\n"]},"metadata":{},"sourceType":"module"}